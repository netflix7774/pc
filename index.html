<!doctype html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
        <title>Pro Hub Desktop v5.4.12</title>
        <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
        <style>
            :root {
                --bg-main: #0a0a0c;
                --sidebar-bg: #161618;
                --accent-blue: #0a84ff;
                --accent-green: #30d158;
                --accent-red: #d90429;
                --text-primary: #ffffff;
                --text-secondary: #8e8e93;
                --glass-bg: rgba(255, 255, 255, 0.05);
                --border-color: rgba(255, 255, 255, 0.1);
                --sidebar-width: 140px;
                --divider-color: #ff6b35;
            }

            body {
                margin: 0;
                padding: 0;
                background-color: var(--bg-main);
                color: var(--text-primary);
                font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
                display: flex;
                height: 100vh;
                overflow: hidden;
            }

            /* ì‚¬ì´ë“œë°” ì ‘ê¸°ìš© ì• ë‹ˆë©”ì´ì…˜ ìŠ¤íƒ€ì¼ */
            .sidebar {
                width: var(--sidebar-width);
                min-width: var(--sidebar-width);
                flex-shrink: 0;
                background: var(--sidebar-bg);
                border-right: 1px solid var(--border-color);
                display: flex;
                flex-direction: column;
                padding: 12px;
                z-index: 100;
                box-sizing: border-box;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                overflow-x: hidden;
                white-space: nowrap;
            }

            body.collapsed .sidebar {
                width: 0;
                min-width: 0;
                padding: 12px 0;
                border-right: none;
                opacity: 0;
                pointer-events: none;
            }

            #modeSwitcher {
                background: rgba(255, 255, 255, 0.08);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.15);
                color: var(--text-primary);
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 13px;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            #noteBtn {
                background: rgba(255, 255, 255, 0.08);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.15);
                color: var(--text-primary);
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 13px;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                margin-left: 8px;
            }

            .brand-title {
                font-size: 11px;
                font-weight: 800;
                margin-bottom: 15px;
                color: var(--accent-blue);
                text-align: center;
            }
            .search-area {
                background: var(--glass-bg);
                border-radius: 8px;
                padding: 8px;
                margin-bottom: 12px;
                border: 1px solid var(--border-color);
                width: 100%;
                box-sizing: border-box;
            }
            .search-input-group {
                display: flex;
                gap: 3px;
                width: 100%;
            }
            .search-input {
                flex: 1;
                min-width: 0;
                background: #2c2c2e;
                border: 1px solid var(--border-color);
                color: white;
                border-radius: 4px;
                padding: 4px 6px;
                font-size: 11px;
                outline: none;
                box-sizing: border-box;
            }
            .btn-search {
                background: var(--accent-blue);
                border: none;
                color: white;
                border-radius: 4px;
                padding: 0 5px;
                cursor: pointer;
                flex-shrink: 0;
            }
            .nav-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 10px;
                padding: 0 2px;
            }
            .nav-label {
                font-size: 9px;
                color: var(--text-secondary);
                text-transform: uppercase;
                font-weight: bold;
            }
            .btn-gear {
                background: none;
                border: none;
                color: var(--text-secondary);
                cursor: pointer;
                font-size: 12px;
                transition: 0.2s;
                padding: 0;
            }
            .btn-gear.active {
                color: var(--accent-blue);
                transform: rotate(45deg);
            }
            #editForm {
                display: none;
                flex-direction: column;
                gap: 6px;
                padding: 8px;
                background: #1c1c1e;
                border-radius: 6px;
                margin-bottom: 10px;
                border: 1px solid var(--accent-blue);
                width: 100%;
                box-sizing: border-box;
            }
            #editForm input {
                width: 100%;
                background: #2c2c2e;
                border: 1px solid var(--border-color);
                color: white;
                padding: 6px;
                border-radius: 3px;
                font-size: 10px;
                outline: none;
                box-sizing: border-box;
            }
            .btn-save {
                width: 100%;
                background: var(--accent-blue);
                border: none;
                color: white;
                padding: 6px;
                border-radius: 3px;
                cursor: pointer;
                font-size: 10px;
                font-weight: bold;
                box-sizing: border-box;
            }
            .sync-group {
                display: flex;
                gap: 4px;
                margin-top: 4px;
            }
            .btn-sync {
                flex: 1;
                background: var(--glass-bg);
                border: 1px solid var(--border-color);
                color: var(--text-secondary);
                padding: 4px;
                border-radius: 3px;
                cursor: pointer;
                font-size: 9px;
            }
            .btn-sync:hover {
                background: rgba(255,255,255,0.1);
                color: white;
            }

            .bookmark-list {
                display: flex;
                flex-direction: column;
                gap: 2px;
                overflow-y: auto;
                flex-grow: 1;
                padding-bottom: 50px;
                scrollbar-width: none;
                width: 100%;
            }
            .bookmark-item {
                padding: 4px 10px;
                border-radius: 6px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: space-between;
                font-size: 12px;
                color: var(--text-secondary);
                background: rgba(255, 255, 255, 0.02);
                user-select: none;
            }
            .bookmark-item.active {
                background: var(--accent-blue);
                color: white;
                font-weight: 600;
            }
            .bookmark-item.editing-now {
                border: 1px dashed var(--accent-blue);
                background: rgba(0, 122, 255, 0.1);
            }
            .del-btn {
                color: var(--accent-red);
                font-weight: 900;
                font-size: 16px;
                margin-left: 8px;
                cursor: pointer;
                padding: 0px 4px;
            }
            .sortable-ghost {
                opacity: 0.3;
                background: var(--accent-blue) !important;
            }

            .floating-title {
                position: absolute;
                top: 15px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1000;
                border-radius: 30px;
                box-shadow: 0 8px 25px rgba(217, 4, 41, 0.5);
                border: 1px solid rgba(255, 255, 255, 0.2);
                min-width: 350px;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .floating-title a {
                background: var(--accent-red);
                color: white;
                text-decoration: none;
                font-size: 20px;
                font-weight: 800;
                padding: 6px 25px;
                display: block;
                width: 100%;
                text-align: center;
                border-radius: 30px;
            }

            /* 1x4 ëª¨ë“œì—ì„œ ì œëª© í¬ê¸° */
            .split-horizontal .floating-title {
                min-width: auto;
                top: 8px;
            }

            .split-horizontal .floating-title a {
                font-size: 20px;
                padding: 6px 25px;
                font-weight: 800;
            }

            /* 2x2 ëª¨ë“œì—ì„œë§Œ ì œëª© í¬ê¸° ì•½ê°„ ì¶•ì†Œ */
            .split-grid .floating-title {
                min-width: auto;
                top: 8px;
            }

            .split-grid .floating-title a {
                font-size: 15.4px;
                padding: 5px 15px;
                font-weight: 800;
            }

            .main-view {
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                background: #000;
                position: relative;
            }
            .top-bar {
                height: 42px;
                background: var(--sidebar-bg);
                border-bottom: 1px solid var(--border-color);
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 0 15px;
            }
            .toolbar-group {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            .input-mini {
                width: 32px;
                background: #2c2c2e;
                border: 1px solid var(--border-color);
                color: white;
                border-radius: 3px;
                padding: 2px;
                text-align: center;
                outline: none;
                font-size: 10px;
            }
            .btn-top-action {
                background: var(--glass-bg);
                border: none;
                color: white;
                cursor: pointer;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 10px;
            }

            .btn-toggle {
                font-size: 16px;
                margin-right: 12px;
                background: none;
                border: none;
                color: white;
                cursor: pointer;
                padding: 0;
            }

            /* í™”ë©´ ë¶„í•  ê´€ë ¨ ìŠ¤íƒ€ì¼ */
            .frame-wrap {
                flex-grow: 1;
                margin: 10px;
                border-radius: 12px;
                overflow: hidden;
                position: relative;
                border: 1px solid var(--border-color);
                background: #ffffff;
                display: flex;
            }

            /* ë¶„í•  ëª¨ë“œë³„ ë ˆì´ì•„ì›ƒ */
            .frame-wrap.split-horizontal {
                flex-direction: row;
            }

            .frame-wrap.split2 {
                flex-direction: row;
            }

            .frame-wrap.split3 {
                flex-direction: row;
            }

            .frame-wrap.split-grid {
                flex-wrap: wrap;
            }

            .frame-container {
                position: relative;
                background: #ffffff;
                overflow: hidden;
                transition: box-shadow 0.3s;
                cursor: pointer;
            }

            /* í”„ë ˆì„ ì„ íƒ ìƒíƒœ í‘œì‹œ */
            .frame-container.selected {
                box-shadow: inset 0 0 0 4px var(--accent-blue);
                z-index: 5;
            }

            /* í”„ë ˆì„ ì„ íƒì„ ìœ„í•œ ì˜¤ë²„ë ˆì´ */
            .frame-overlay {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: 2;
                background: transparent;
                transition: background 0.2s;
            }

            .frame-overlay:hover {
                background: rgba(10, 132, 255, 0.05);
            }

            .frame-container.selected .frame-overlay {
                pointer-events: none;
            }

            /* ë‹¨ì¼ ëª¨ë“œ */
            .frame-wrap.split-single .frame-container {
                width: 100%;
                height: 100%;
            }

            /* ì„¸ë¡œ 2ë¶„í•  (1x2) */
            .frame-wrap.split2 .frame-container {
                width: 50%;
                height: 100%;
            }

            /* ì„¸ë¡œ 3ë¶„í•  (1x3) */
            .frame-wrap.split3 .frame-container {
                width: 33.333%;
                height: 100%;
            }

            /* ì„¸ë¡œ 4ë¶„í•  (1x4) */
            .frame-wrap.split-horizontal .frame-container {
                width: 25%;
                height: 100%;
            }

            /* 2x2 ê·¸ë¦¬ë“œ */
            .frame-wrap.split-grid .frame-container {
                width: 50%;
                height: 50%;
            }

            /* ë¦¬ì‚¬ì´ì € ë°” */
            .resizer {
                background: var(--divider-color);
                position: absolute;
                z-index: 10;
            }

            .resizer:hover {
                background: #ff8c5a;
            }

            .resizer.horizontal {
                width: 100%;
                height: 4px;
                cursor: row-resize;
                left: 0;
            }

            .resizer.vertical {
                width: 4px;
                height: 100%;
                cursor: col-resize;
                top: 0;
            }

            .resizer.dragging {
                background: #ffa366;
            }

            iframe {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border: none;
                transition: opacity 0.3s;
            }

            /* ë¶„í•  ëª¨ë“œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
            .split-controls {
                display: flex;
                gap: 8px;
                align-items: center;
                border-left: 1px solid var(--border-color);
                padding-left: 12px;
                margin-left: 12px;
                position: relative;
            }

            .btn-split-current {
                background: var(--accent-blue);
                border: 1px solid var(--accent-blue);
                color: white;
                cursor: pointer;
                padding: 4px 12px;
                border-radius: 4px;
                font-size: 10px;
                font-weight: 600;
                position: relative;
            }

            .btn-split-current:hover {
                background: #0070e0;
            }

            .split-dropdown {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                margin-top: 4px;
                background: var(--sidebar-bg);
                border: 1px solid var(--border-color);
                border-radius: 6px;
                padding: 4px;
                z-index: 10000;
                min-width: 80px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }

            .split-dropdown.show {
                display: flex;
                flex-direction: column;
                gap: 2px;
            }

            .split-dropdown-item {
                background: var(--glass-bg);
                border: 1px solid var(--border-color);
                color: white;
                cursor: pointer;
                padding: 6px 12px;
                border-radius: 4px;
                font-size: 10px;
                text-align: center;
                transition: all 0.2s;
            }

            .split-dropdown-item:hover {
                background: rgba(255, 255, 255, 0.15);
                border-color: var(--accent-blue);
            }

            .split-dropdown-item.active {
                background: var(--accent-blue);
                border-color: var(--accent-blue);
            }

            .btn-split {
                background: var(--glass-bg);
                border: 1px solid var(--border-color);
                color: white;
                cursor: pointer;
                padding: 4px 10px;
                border-radius: 4px;
                font-size: 10px;
                transition: all 0.2s;
            }

            .btn-split.active {
                background: var(--accent-blue);
                border-color: var(--accent-blue);
            }

            .btn-split:hover {
                background: rgba(255, 255, 255, 0.1);
            }
        </style>
    </head>
    <body>
        <div class="sidebar">
            <div class="brand-title">PRO HUB v5.4</div>
            <div class="search-area">
                <div class="search-input-group">
                    <input type="text" id="searchKeyword" class="search-input" placeholder="Search" onkeypress="if (event.key === 'Enter') executeSearch();" />
                    <button class="btn-search" onclick="executeSearch()">ğŸ”</button>
                </div>
            </div>
            <div class="nav-header">
                <span class="nav-label">FAV</span>
                <button id="gearBtn" class="btn-gear" onclick="toggleEditMode()">âš™ï¸</button>
            </div>
            <div id="editForm">
                <input type="text" id="pcBmName" placeholder="Name" />
                <input type="text" id="pcBmUrl" placeholder="URL" />
                <button class="btn-save" onclick="handleBookmarkSubmit()">Save</button>
                <div class="sync-group">
                    <button class="btn-sync" onclick="exportBookmarks()">Export</button>
                    <button class="btn-sync" onclick="importBookmarks()">Import</button>
                </div>
            </div>
            <div class="bookmark-list" id="pcSortableList"></div>
        </div>

        <main class="main-view">
            <header class="top-bar">
                <div style="display: flex; align-items: center; margin-right: auto">
                    <button class="btn-toggle" onclick="toggleSidebar()">â˜°</button>
                    <button id="modeSwitcher" onclick="goToMobileSite()"><span>ğŸ“±</span> <span>Mobile</span></button>
                    <button id="noteBtn" onclick="openNote()"><span>ğŸ“</span> <span>Note</span></button>
                </div>

                <div class="toolbar-group">
                    <div class="split-controls">
                        <button class="btn-split-current" onclick="toggleSplitDropdown()">1x1 â–¼</button>
                        <div class="split-dropdown" id="splitDropdown">
                            <div class="split-dropdown-item active" onclick="setSplitMode('single')">1x1</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('split2')">1x2</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('split3')">1x3</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('horizontal')">1x4</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('grid')">2x2</div>
                        </div>
                    </div>
                    <div class="ctrl-item" style="font-size: 10px; color: var(--text-secondary)"><span>CROP</span><input type="number" id="pcCropValue" class="input-mini" value="0" oninput="applyPcCrop()" /></div>
                    <div class="ctrl-item" style="border-left: 1px solid var(--border-color); padding-left: 10px; display: flex; gap: 5px">
                        <button id="modeToggleBtn" class="btn-top-action" onclick="toggleCycleMode()">All</button>
                        <input type="number" id="cycleInterval" class="input-mini" value="10" />
                        <button id="cycleBtn" class="btn-top-action" onclick="toggleCycle()">Go</button>
                    </div>
                    <button onclick="smartRefresh()" class="btn-top-action">â†»</button>
                </div>
            </header>

            <div class="frame-wrap split-single" id="frameWrap">
                <!-- í”„ë ˆì„ë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
        </main>

        <script>
            let currentUrl = 'https://m.fmkorea.com/',
                isEditMode = false,
                editingIndex = -1;
            let cycleIntervalTimer = null,
                cycleMode = 'all',
                sortableInstance = null;

            // í™”ë©´ ë¶„í•  ê´€ë ¨ ë³€ìˆ˜
            let splitMode = 'single';
            let selectedFrameIndex = 0; // í˜„ì¬ ì„ íƒëœ í”„ë ˆì„ ì¸ë±ìŠ¤
            let frameUrls = ['https://m.fmkorea.com/', '', '', ''];
            let frameTitles = ['í¬í…', '', '', ''];
            let resizeState = {
                isResizing: false,
                startPos: 0,
                startSize: 0,
                targetIndex: -1,
                direction: ''
            };

            // í”„ë ˆì„ í¬ê¸° ë¹„ìœ¨ (ì´ˆê¸°ê°’ 50:50)
            let frameSizes = {
                split2: [50, 50], // 1x2
                split3: [33.333, 33.333, 33.334], // 1x3
                horizontal: [25, 25, 25, 25], // 1x4
                grid: [50, 50, 50, 50] // 2x2
            };

            // ë“œë¡­ë‹¤ìš´ í† ê¸€
            function toggleSplitDropdown() {
                const dropdown = document.getElementById('splitDropdown');
                dropdown.classList.toggle('show');
            }

            // ë“œë¡­ë‹¤ìš´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
            document.addEventListener('click', function(e) {
                const dropdown = document.getElementById('splitDropdown');
                const button = document.querySelector('.btn-split-current');
                if (dropdown && button && !dropdown.contains(e.target) && !button.contains(e.target)) {
                    dropdown.classList.remove('show');
                }
            });

            function toggleSidebar() {
                document.body.classList.toggle('collapsed');
            }

            function openNote() {
                const prevUrl = currentUrl;
                const prevTitle = document.getElementById('standardTitle') ? document.getElementById('standardTitle').innerText.replace(/'/g, "\\'") : 'í¬í…';

                // ë‹¨ì¼ ëª¨ë“œë¡œ ì „í™˜
                if (splitMode !== 'single') {
                    setSplitMode('single');
                }

                const frame = document.getElementById('frame-0');
                const title = document.getElementById('title-0');
                if (title) title.innerText = 'Personal Note';

                const savedNote = localStorage.getItem('myHubNote') || '';
                frame.style.opacity = '0';

                frame.srcdoc = `
            <html>
            <head>
                <style>
                    body { background: #f8f9fa; color: #0f1419; font-family: -apple-system, sans-serif; display: flex; flex-direction: column; height: 100vh; margin: 0; padding: 60px 20px 20px; box-sizing: border-box; }
                    .note-container { flex-grow: 1; display: flex; flex-direction: column; gap: 15px; max-width: 800px; margin: 0 auto; width: 100%; animation: fadeIn 0.4s ease; }
                    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
                    textarea { flex-grow: 1; background: #ffffff; border: 1px solid #e1e8ed; border-radius: 16px; color: #0f1419; padding: 25px; font-size: 16px; line-height: 1.6; outline: none; resize: none; transition: 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
                    textarea:focus { border-color: #0a84ff; box-shadow: 0 4px 20px rgba(10, 132, 255, 0.15); }
                    .actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 10px; }
                    button { padding: 12px 28px; border-radius: 30px; font-weight: 700; cursor: pointer; border: none; transition: 0.2s; font-size: 14px; }
                    .btn-save { background: #0a84ff; color: white; box-shadow: 0 4px 10px rgba(10, 132, 255, 0.3); }
                    .btn-save:hover { background: #0070e0; transform: scale(1.03); }
                    .btn-close { background: #f0f3f4; color: #536471; }
                    .btn-close:hover { background: #e2e5e7; }
                </style>
            </head>
            <body>
                <div class="note-container">
                    <textarea id="noteArea" placeholder="ë‚˜ë§Œì˜ ì‘ì—… ë©”ëª¨ë¥¼ ë‚¨ê²¨ë³´ì„¸ìš”...">${savedNote}</textarea>
                    <div class="actions">
                        <button class="btn-close" onclick="window.parent.loadSite('${prevUrl}', '${prevTitle}')">Close</button>
                        <button class="btn-save" onclick="saveNote()">Save Note</button>
                    </div>
                </div>
                <script>
                    function saveNote() {
                        const val = document.getElementById('noteArea').value;
                        localStorage.setItem('myHubNote', val);
                        alert('ë©”ëª¨ê°€ ì•ˆì „í•˜ê²Œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    }
                <\/script>
            </body>
            </html>
        `;
                setTimeout(() => {
                    frame.style.opacity = '1';
                }, 50);
            }

            function initSortable() {
                const el = document.getElementById('pcSortableList');
                if (sortableInstance) sortableInstance.destroy();
                sortableInstance = new Sortable(el, {
                    animation: 350,
                    disabled: !isEditMode,
                    ghostClass: 'sortable-ghost',
                    forceFallback: true,
                    filter: '.del-btn',
                    onEnd: function () {
                        const items = el.querySelectorAll('.bookmark-item');
                        const newOrder = Array.from(items).map((item) => ({ name: item.dataset.name, url: item.dataset.url }));
                        localStorage.setItem('myHubBookmarks', JSON.stringify(newOrder));
                    },
                });
            }

            function renderBookmarks() {
                const container = document.getElementById('pcSortableList'),
                    bms = JSON.parse(localStorage.getItem('myHubBookmarks')) || [];
                container.innerHTML = bms
                    .map((bm, index) => {
                        const isActive = !isEditMode && bm.url === currentUrl ? 'active' : '';
                        const isEditing = editingIndex === index ? 'editing-now' : '';
                        return `<div class="bookmark-item ${isActive} ${isEditing}" onclick="handleItemClick(${index}, event)" data-name="${bm.name}" data-url="${bm.url}">
                        <span>${bm.name}</span>${isEditMode ? `<div class="del-btn" onclick="deleteBookmark(${index}, event)">Ã—</div>` : ''}
                    </div>`;
                    })
                    .join('');
                initSortable();
            }

            function handleItemClick(idx, e) {
                if (e.target.classList.contains('del-btn')) return;
                const bms = JSON.parse(localStorage.getItem('myHubBookmarks'));
                if (isEditMode) {
                    if (editingIndex === idx) {
                        editingIndex = -1;
                        document.getElementById('pcBmName').value = '';
                        document.getElementById('pcBmUrl').value = '';
                    } else {
                        editingIndex = idx;
                        document.getElementById('pcBmName').value = bms[idx].name;
                        document.getElementById('pcBmUrl').value = bms[idx].url.replace(/^https?:\/\//i, '');
                    }
                    renderBookmarks();
                } else {
                    loadSite(bms[idx].url, bms[idx].name);
                }
            }

            function deleteBookmark(idx, e) {
                e.stopPropagation();
                if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
                let bms = JSON.parse(localStorage.getItem('myHubBookmarks'));
                bms.splice(idx, 1);
                localStorage.setItem('myHubBookmarks', JSON.stringify(bms));
                if (editingIndex === idx) editingIndex = -1;
                renderBookmarks();
            }

            function toggleEditMode() {
                isEditMode = !isEditMode;
                document.getElementById('gearBtn').classList.toggle('active', isEditMode);
                document.getElementById('editForm').style.display = isEditMode ? 'flex' : 'none';
                if (!isEditMode) {
                    editingIndex = -1;
                    document.getElementById('pcBmName').value = '';
                    document.getElementById('pcBmUrl').value = '';
                }
                renderBookmarks();
            }

            function handleBookmarkSubmit() {
                const name = document.getElementById('pcBmName').value.trim();
                let url = document.getElementById('pcBmUrl').value.trim();
                if (!name || !url) return;
                if (!/^https?:\/\//i.test(url)) url = 'https://' + url;
                let bms = JSON.parse(localStorage.getItem('myHubBookmarks')) || [];
                if (editingIndex > -1) bms[editingIndex] = { name, url };
                else bms.push({ name, url });
                localStorage.setItem('myHubBookmarks', JSON.stringify(bms));
                editingIndex = -1;
                document.getElementById('pcBmName').value = '';
                document.getElementById('pcBmUrl').value = '';
                renderBookmarks();
            }

            // í”„ë ˆì„ ì„ íƒ í•¨ìˆ˜
            function selectFrame(index) {
                selectedFrameIndex = index;
                // ëª¨ë“  í”„ë ˆì„ì˜ ì„ íƒ ìƒíƒœ ì œê±°
                document.querySelectorAll('.frame-container').forEach((container, i) => {
                    if (i === index) {
                        container.classList.add('selected');
                    } else {
                        container.classList.remove('selected');
                    }
                });
            }

            function loadSite(url, title) {
                if (splitMode === 'single') {
                    // ë‹¨ì¼ ëª¨ë“œ: ê¸°ì¡´ ë°©ì‹ëŒ€ë¡œ
                    currentUrl = url;
                    frameUrls[0] = url;
                    frameTitles[0] = title;
                    const frame = document.getElementById('frame-0');
                    const titleEl = document.getElementById('title-0');
                    
                    if (titleEl) {
                        titleEl.innerText = title;
                        titleEl.href = url;
                    }
                    
                    frame.style.opacity = '0';
                    frame.removeAttribute('srcdoc');
                    frame.src = url;
                    frame.onload = () => {
                        frame.style.opacity = '1';
                        applyPcCrop();
                    };
                } else {
                    // ë¶„í•  ëª¨ë“œ: ì„ íƒëœ í”„ë ˆì„ì— ë¡œë“œ
                    frameUrls[selectedFrameIndex] = url;
                    frameTitles[selectedFrameIndex] = title;
                    
                    const frame = document.getElementById(`frame-${selectedFrameIndex}`);
                    const titleEl = document.getElementById(`title-${selectedFrameIndex}`);
                    
                    if (titleEl) {
                        titleEl.innerText = title;
                        titleEl.href = url;
                    }
                    
                    frame.style.opacity = '0';
                    frame.removeAttribute('srcdoc');
                    frame.src = url;
                    frame.onload = () => {
                        frame.style.opacity = '1';
                        applyPcCrop();
                    };
                }
                
                renderBookmarks();
            }

            function smartRefresh() {
                if (splitMode === 'single') {
                    const frame = document.getElementById('frame-0');
                    frame.src = currentUrl + (currentUrl.includes('?') ? '&' : '?') + 'r=' + Date.now();
                    frame.onload = () => applyPcCrop();
                } else {
                    // ë¶„í•  ëª¨ë“œì—ì„œëŠ” í˜„ì¬ ë³´ì´ëŠ” ëª¨ë“  í”„ë ˆì„ ìƒˆë¡œê³ ì¹¨
                    const maxFrames = splitMode === 'split2' ? 2 : splitMode === 'split3' ? 3 : 4;
                    for (let i = 0; i < maxFrames; i++) {
                        const frame = document.getElementById(`frame-${i}`);
                        if (frameUrls[i] && frame) {
                            frame.src = frameUrls[i] + (frameUrls[i].includes('?') ? '&' : '?') + 'r=' + Date.now();
                            frame.onload = () => applyPcCrop();
                        }
                    }
                }
            }

            function applyPcCrop() {
                const val = document.getElementById('pcCropValue').value || 0;
                
                if (splitMode === 'single') {
                    const frame = document.getElementById('frame-0');
                    if (frame) {
                        frame.style.top = `-${val}%`;
                        frame.style.height = `${100 + parseInt(val)}%`;
                    }
                } else {
                    // ë¶„í•  ëª¨ë“œì—ì„œëŠ” ëª¨ë“  í”„ë ˆì„ì— ì ìš©
                    const maxFrames = splitMode === 'split2' ? 2 : splitMode === 'split3' ? 3 : 4;
                    for (let i = 0; i < maxFrames; i++) {
                        const frame = document.getElementById(`frame-${i}`);
                        if (frame) {
                            frame.style.top = `-${val}%`;
                            frame.style.height = `${100 + parseInt(val)}%`;
                        }
                    }
                }
            }

            function toggleCycleMode() {
                // ë¶„í•  ëª¨ë“œì—ì„œëŠ” í† ê¸€ ë¶ˆê°€
                if (splitMode !== 'single') return;
                
                const btn = document.getElementById('modeToggleBtn');
                cycleMode = cycleMode === 'all' ? 'single' : 'all';
                btn.innerText = cycleMode === 'all' ? 'All' : 'One';
            }

            function toggleCycle() {
                const btn = document.getElementById('cycleBtn');
                if (cycleIntervalTimer) {
                    clearInterval(cycleIntervalTimer);
                    cycleIntervalTimer = null;
                    btn.innerText = 'Go';
                } else {
                    let sec = parseInt(document.getElementById('cycleInterval').value) || 10;
                    btn.innerText = 'Stop';
                    cycleIntervalTimer = setInterval(() => {
                        if (splitMode === 'single') {
                            // ë‹¨ì¼ ëª¨ë“œ
                            if (cycleMode === 'all') {
                                const bms = JSON.parse(localStorage.getItem('myHubBookmarks'));
                                let idx = bms.findIndex((bm) => bm.url === currentUrl);
                                let next = (idx + 1) % bms.length;
                                loadSite(bms[next].url, bms[next].name);
                            } else {
                                smartRefresh();
                            }
                        } else {
                            // ë¶„í•  ëª¨ë“œ - ëª¨ë“  í”„ë ˆì„ ìƒˆë¡œê³ ì¹¨
                            const maxFrames = splitMode === 'split2' ? 2 : splitMode === 'split3' ? 3 : 4;
                            for (let i = 0; i < maxFrames; i++) {
                                const frame = document.getElementById(`frame-${i}`);
                                if (frameUrls[i] && frame) {
                                    frame.src = frameUrls[i] + (frameUrls[i].includes('?') ? '&' : '?') + 'r=' + Date.now();
                                    frame.onload = () => applyPcCrop();
                                }
                            }
                        }
                    }, sec * 1000);
                }
            }

            function executeSearch() {
                const input = document.getElementById('searchKeyword'),
                    keyword = input.value.trim();
                if (!keyword) return;
                loadSite('https://m.fmkorea.com/search.php?act=IS&is_keyword=' + encodeURIComponent(keyword), 'Search Result');
                input.value = '';
            }

            function goToMobileSite() {
                window.location.href = 'https://netflix7774.github.io/mobile/index.html';
            }

            function exportBookmarks() {
                const bms = localStorage.getItem('myHubBookmarks');
                if (!bms) return alert('ë‚´ë³´ë‚¼ ë¶ë§ˆí¬ê°€ ì—†ìŠµë‹ˆë‹¤.');
                const blob = new Blob([bms], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `pro_hub_bookmarks_${new Date().toISOString().slice(0,10)}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }

            function importBookmarks() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = e => {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = event => {
                        try {
                            const data = JSON.parse(event.target.result);
                            if (Array.isArray(data)) {
                                if(confirm('ê¸°ì¡´ ë¶ë§ˆí¬ë¥¼ ë®ì–´ì“°ê³  ìƒˆë¡œ ê°€ì ¸ì˜¤ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                                    localStorage.setItem('myHubBookmarks', JSON.stringify(data));
                                    renderBookmarks();
                                    alert('ë¶ë§ˆí¬ ë™ê¸°í™”ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.');
                                }
                            } else alert('ìœ íš¨í•œ ë¶ë§ˆí¬ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤.');
                        } catch (err) { alert('íŒŒì¼ ì½ê¸° ì˜¤ë¥˜ì…ë‹ˆë‹¤.'); }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            // í™”ë©´ ë¶„í•  ëª¨ë“œ ì„¤ì •
            function setSplitMode(mode) {
                splitMode = mode;
                selectedFrameIndex = 0; // í”„ë ˆì„ ì„ íƒ ì¸ë±ìŠ¤ ì´ˆê¸°í™”
                
                // ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
                document.getElementById('splitDropdown').classList.remove('show');
                
                // ë“œë¡­ë‹¤ìš´ ì•„ì´í…œ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
                document.querySelectorAll('.split-dropdown-item').forEach(item => item.classList.remove('active'));
                event.target.classList.add('active');
                
                // í˜„ì¬ ë²„íŠ¼ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
                const modeNames = {
                    'single': '1x1',
                    'split2': '1x2',
                    'split3': '1x3',
                    'horizontal': '1x4',
                    'grid': '2x2'
                };
                document.querySelector('.btn-split-current').innerText = modeNames[mode] + ' â–¼';
                
                // ë¶„í•  ëª¨ë“œì¼ ë•Œ ìë™ìœ¼ë¡œ 'One' ëª¨ë“œë¡œ ì „í™˜
                if (mode !== 'single') {
                    cycleMode = 'single';
                    document.getElementById('modeToggleBtn').innerText = 'One';
                    document.getElementById('modeToggleBtn').disabled = true;
                    document.getElementById('modeToggleBtn').style.opacity = '0.5';
                    document.getElementById('modeToggleBtn').style.cursor = 'not-allowed';
                } else {
                    // ë‹¨ì¼ ëª¨ë“œë¡œ ëŒì•„ì˜¬ ë•Œ ì›ë˜ëŒ€ë¡œ ë³µêµ¬
                    document.getElementById('modeToggleBtn').disabled = false;
                    document.getElementById('modeToggleBtn').style.opacity = '1';
                    document.getElementById('modeToggleBtn').style.cursor = 'pointer';
                }
                
                renderFrames();
            }

            // í”„ë ˆì„ ë Œë”ë§
            function renderFrames() {
                const wrap = document.getElementById('frameWrap');
                wrap.className = `frame-wrap split-${splitMode}`;
                wrap.innerHTML = '';

                if (splitMode === 'single') {
                    // ë‹¨ì¼ ëª¨ë“œ
                    wrap.innerHTML = `
                        <div class="frame-container" id="container-0">
                            <div class="floating-title" id="title-container-0">
                                <a id="title-0" href="${frameUrls[0]}" target="_blank">${frameTitles[0]}</a>
                            </div>
                            <iframe id="frame-0" src="${frameUrls[0]}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        </div>
                    `;
                    currentUrl = frameUrls[0];
                } else if (splitMode === 'split2') {
                    // ì„¸ë¡œ 2ë¶„í•  (1x2)
                    for (let i = 0; i < 2; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        container.style.width = `${frameSizes.split2[i]}%`;
                        
                        container.innerHTML = `
                            <div class="frame-overlay" onclick="selectFrame(${i})"></div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[i] || '#'}" target="_blank">${frameTitles[i] || `í”„ë ˆì„ ${i + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[i] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        // ë¦¬ì‚¬ì´ì € ì¶”ê°€ (ë§ˆì§€ë§‰ í”„ë ˆì„ ì œì™¸)
                        if (i < 1) {
                            const resizer = document.createElement('div');
                            resizer.className = 'resizer vertical';
                            resizer.dataset.index = i;
                            resizer.style.left = `${frameSizes.split2.slice(0, i + 1).reduce((a, b) => a + b, 0)}%`;
                            resizer.addEventListener('mousedown', startResize);
                            wrap.appendChild(resizer);
                        }
                    }
                    // ì²« ë²ˆì§¸ í”„ë ˆì„ ì„ íƒ
                    selectFrame(0);
                } else if (splitMode === 'split3') {
                    // ì„¸ë¡œ 3ë¶„í•  (1x3)
                    for (let i = 0; i < 3; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        container.style.width = `${frameSizes.split3[i]}%`;
                        
                        container.innerHTML = `
                            <div class="frame-overlay" onclick="selectFrame(${i})"></div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[i] || '#'}" target="_blank">${frameTitles[i] || `í”„ë ˆì„ ${i + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[i] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        // ë¦¬ì‚¬ì´ì € ì¶”ê°€ (ë§ˆì§€ë§‰ í”„ë ˆì„ ì œì™¸)
                        if (i < 2) {
                            const resizer = document.createElement('div');
                            resizer.className = 'resizer vertical';
                            resizer.dataset.index = i;
                            resizer.style.left = `${frameSizes.split3.slice(0, i + 1).reduce((a, b) => a + b, 0)}%`;
                            resizer.addEventListener('mousedown', startResize);
                            wrap.appendChild(resizer);
                        }
                    }
                    // ì²« ë²ˆì§¸ í”„ë ˆì„ ì„ íƒ
                    selectFrame(0);
                } else if (splitMode === 'horizontal') {
                    // ì„¸ë¡œ 4ë¶„í•  (1x4)
                    for (let i = 0; i < 4; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        container.style.width = `${frameSizes.horizontal[i]}%`;
                        
                        container.innerHTML = `
                            <div class="frame-overlay" onclick="selectFrame(${i})"></div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[i] || '#'}" target="_blank">${frameTitles[i] || `í”„ë ˆì„ ${i + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[i] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        // ë¦¬ì‚¬ì´ì € ì¶”ê°€ (ë§ˆì§€ë§‰ í”„ë ˆì„ ì œì™¸)
                        if (i < 3) {
                            const resizer = document.createElement('div');
                            resizer.className = 'resizer vertical';
                            resizer.dataset.index = i;
                            resizer.style.left = `${frameSizes.horizontal.slice(0, i + 1).reduce((a, b) => a + b, 0)}%`;
                            resizer.addEventListener('mousedown', startResize);
                            wrap.appendChild(resizer);
                        }
                    }
                    // ì²« ë²ˆì§¸ í”„ë ˆì„ ì„ íƒ
                    selectFrame(0);
                } else if (splitMode === 'grid') {
                    // 2x2 ê·¸ë¦¬ë“œ
                    for (let i = 0; i < 4; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        
                        if (i < 2) {
                            container.style.height = `${frameSizes.grid[0]}%`;
                        } else {
                            container.style.height = `${frameSizes.grid[2]}%`;
                        }
                        
                        if (i % 2 === 0) {
                            container.style.width = `${frameSizes.grid[i]}%`;
                        } else {
                            container.style.width = `${frameSizes.grid[i]}%`;
                        }
                        
                        container.innerHTML = `
                            <div class="frame-overlay" onclick="selectFrame(${i})"></div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[i] || '#'}" target="_blank">${frameTitles[i] || `í”„ë ˆì„ ${i + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[i] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                    }
                    
                    // ê°€ë¡œ ë¦¬ì‚¬ì´ì € (ì¤‘ê°„)
                    const hResizer = document.createElement('div');
                    hResizer.className = 'resizer horizontal';
                    hResizer.dataset.index = '0';
                    hResizer.style.top = `${frameSizes.grid[0]}%`;
                    hResizer.addEventListener('mousedown', startResize);
                    wrap.appendChild(hResizer);
                    
                    // ì„¸ë¡œ ë¦¬ì‚¬ì´ì € (ì™¼ìª½)
                    const vResizer1 = document.createElement('div');
                    vResizer1.className = 'resizer vertical';
                    vResizer1.dataset.index = '0';
                    vResizer1.style.left = `${frameSizes.grid[0]}%`;
                    vResizer1.style.height = `${frameSizes.grid[0]}%`;
                    vResizer1.addEventListener('mousedown', startResize);
                    wrap.appendChild(vResizer1);
                    
                    // ì„¸ë¡œ ë¦¬ì‚¬ì´ì € (ì˜¤ë¥¸ìª½)
                    const vResizer2 = document.createElement('div');
                    vResizer2.className = 'resizer vertical';
                    vResizer2.dataset.index = '1';
                    vResizer2.style.left = `${frameSizes.grid[2]}%`;
                    vResizer2.style.top = `${frameSizes.grid[0]}%`;
                    vResizer2.style.height = `${100 - frameSizes.grid[0]}%`;
                    vResizer2.addEventListener('mousedown', startResize);
                    wrap.appendChild(vResizer2);
                    
                    // ì²« ë²ˆì§¸ í”„ë ˆì„ ì„ íƒ
                    selectFrame(0);
                }
                
                // í”„ë ˆì„ ë Œë”ë§ í›„ crop ì ìš©
                setTimeout(() => applyPcCrop(), 100);
            }

            // ë¦¬ì‚¬ì´ì¦ˆ ì‹œì‘
            function startResize(e) {
                e.preventDefault();
                resizeState.isResizing = true;
                resizeState.targetIndex = parseInt(e.target.dataset.index);
                resizeState.direction = e.target.classList.contains('horizontal') ? 'horizontal' : 'vertical';
                resizeState.startPos = resizeState.direction === 'horizontal' ? e.clientY : e.clientX;
                
                e.target.classList.add('dragging');
                
                document.addEventListener('mousemove', handleResize);
                document.addEventListener('mouseup', stopResize);
            }

            // ë¦¬ì‚¬ì´ì¦ˆ ì²˜ë¦¬
            function handleResize(e) {
                if (!resizeState.isResizing) return;
                
                const wrap = document.getElementById('frameWrap');
                const rect = wrap.getBoundingClientRect();
                
                if (splitMode === 'split2') {
                    const deltaX = e.clientX - resizeState.startPos;
                    const deltaPercent = (deltaX / rect.width) * 100;
                    
                    const idx = resizeState.targetIndex;
                    const newSize1 = frameSizes.split2[idx] + deltaPercent;
                    const newSize2 = frameSizes.split2[idx + 1] - deltaPercent;
                    
                    if (newSize1 > 10 && newSize2 > 10) {
                        frameSizes.split2[idx] = newSize1;
                        frameSizes.split2[idx + 1] = newSize2;
                        resizeState.startPos = e.clientX;
                        renderFrames();
                    }
                } else if (splitMode === 'split3') {
                    const deltaX = e.clientX - resizeState.startPos;
                    const deltaPercent = (deltaX / rect.width) * 100;
                    
                    const idx = resizeState.targetIndex;
                    const newSize1 = frameSizes.split3[idx] + deltaPercent;
                    const newSize2 = frameSizes.split3[idx + 1] - deltaPercent;
                    
                    if (newSize1 > 10 && newSize2 > 10) {
                        frameSizes.split3[idx] = newSize1;
                        frameSizes.split3[idx + 1] = newSize2;
                        resizeState.startPos = e.clientX;
                        renderFrames();
                    }
                } else if (splitMode === 'horizontal') {
                    const deltaX = e.clientX - resizeState.startPos;
                    const deltaPercent = (deltaX / rect.width) * 100;
                    
                    const idx = resizeState.targetIndex;
                    const newSize1 = frameSizes.horizontal[idx] + deltaPercent;
                    const newSize2 = frameSizes.horizontal[idx + 1] - deltaPercent;
                    
                    if (newSize1 > 10 && newSize2 > 10) {
                        frameSizes.horizontal[idx] = newSize1;
                        frameSizes.horizontal[idx + 1] = newSize2;
                        resizeState.startPos = e.clientX;
                        renderFrames();
                    }
                } else if (splitMode === 'grid') {
                    if (resizeState.direction === 'horizontal') {
                        const deltaY = e.clientY - resizeState.startPos;
                        const deltaPercent = (deltaY / rect.height) * 100;
                        
                        const newSize1 = frameSizes.grid[0] + deltaPercent;
                        const newSize2 = 100 - newSize1;
                        
                        if (newSize1 > 20 && newSize2 > 20) {
                            frameSizes.grid[0] = frameSizes.grid[1] = newSize1;
                            frameSizes.grid[2] = frameSizes.grid[3] = newSize2;
                            resizeState.startPos = e.clientY;
                            renderFrames();
                        }
                    } else {
                        const deltaX = e.clientX - resizeState.startPos;
                        const deltaPercent = (deltaX / rect.width) * 100;
                        
                        if (resizeState.targetIndex === 0) {
                            const newSize = frameSizes.grid[0] + deltaPercent;
                            if (newSize > 20 && newSize < 80) {
                                frameSizes.grid[0] = frameSizes.grid[2] = newSize;
                                frameSizes.grid[1] = frameSizes.grid[3] = 100 - newSize;
                                resizeState.startPos = e.clientX;
                                renderFrames();
                            }
                        }
                    }
                }
            }

            // ë¦¬ì‚¬ì´ì¦ˆ ì¢…ë£Œ
            function stopResize(e) {
                if (!resizeState.isResizing) return;
                
                resizeState.isResizing = false;
                document.querySelectorAll('.resizer').forEach(r => r.classList.remove('dragging'));
                
                document.removeEventListener('mousemove', handleResize);
                document.removeEventListener('mouseup', stopResize);
            }

            window.onload = () => {
                if (!localStorage.getItem('myHubBookmarks')) localStorage.setItem('myHubBookmarks', JSON.stringify([{ name: 'í¬í…', url: 'https://m.fmkorea.com/' }]));
                renderBookmarks();
                renderFrames();
            };
        </script>
    </body>
</html>