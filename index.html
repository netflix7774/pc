<!doctype html>
<html lang="ko">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
        <title>Pro Hub Desktop v5.5.0 Dark</title>
        <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
        <style>
            :root {
                --bg-main: #0a0a0c;
                --sidebar-bg: #161618;
                --accent-blue: #0a84ff;
                --accent-green: #30d158;
                --accent-red: #d90429;
                --text-primary: #ffffff;
                --text-secondary: #8e8e93;
                --glass-bg: rgba(255, 255, 255, 0.05);
                --border-color: rgba(255, 255, 255, 0.1);
                --sidebar-width: 140px;
                --divider-color: #ff6b35;
            }

            body {
                margin: 0;
                padding: 0;
                background-color: var(--bg-main);
                color: var(--text-primary);
                font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
                display: flex;
                height: 100vh;
                overflow: hidden;
            }

            /* ÏÇ¨Ïù¥ÎìúÎ∞î Ï†ëÍ∏∞Ïö© Ïï†ÎãàÎ©îÏù¥ÏÖò Ïä§ÌÉÄÏùº */
            .sidebar {
                width: var(--sidebar-width);
                min-width: var(--sidebar-width);
                flex-shrink: 0;
                background: var(--sidebar-bg);
                border-right: 1px solid var(--border-color);
                display: flex;
                flex-direction: column;
                padding: 12px;
                z-index: 100;
                box-sizing: border-box;
                transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
                overflow-x: hidden;
                white-space: nowrap;
            }

            body.collapsed .sidebar {
                width: 0;
                min-width: 0;
                padding: 12px 0;
                border-right: none;
                opacity: 0;
                pointer-events: none;
            }

            #modeSwitcher {
                background: rgba(255, 255, 255, 0.08);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.15);
                color: var(--text-primary);
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 13px;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
            }

            #noteBtn {
                background: rgba(255, 255, 255, 0.08);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.15);
                color: var(--text-primary);
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 13px;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                margin-left: 8px;
            }

            /* Îã§ÌÅ¨Î™®Îìú ÌÜ†Í∏Ä Î≤ÑÌäº */
            #darkModeBtn {
                background: rgba(255, 255, 255, 0.08);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.15);
                color: var(--text-primary);
                padding: 5px 12px;
                border-radius: 20px;
                font-size: 13px;
                font-weight: 600;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 8px;
                margin-left: 8px;
                transition: all 0.3s;
            }

            #darkModeBtn.active {
                background: rgba(48, 209, 88, 0.2);
                border-color: var(--accent-green);
                color: var(--accent-green);
            }

            .brand-title {
                font-size: 11px;
                font-weight: 800;
                margin-bottom: 15px;
                color: var(--accent-blue);
                text-align: center;
            }

            /* Ï°∞Í±¥ Í≤ÄÏÉâ ÏòÅÏó≠ Ïä§ÌÉÄÏùº */
            .search-area {
                background: var(--glass-bg);
                border-radius: 8px;
                padding: 8px;
                margin-bottom: 12px;
                border: 1px solid var(--border-color);
                width: 100%;
                box-sizing: border-box;
            }
            
            .search-select {
                width: 100%;
                background: #2c2c2e;
                border: 1px solid var(--border-color);
                color: white;
                border-radius: 4px;
                padding: 4px 6px;
                font-size: 10px;
                outline: none;
                box-sizing: border-box;
                margin-bottom: 4px;
                cursor: pointer;
            }
            
            .search-input-group {
                display: flex;
                gap: 3px;
                width: 100%;
            }
            
            .search-input {
                flex: 1;
                min-width: 0;
                background: #2c2c2e;
                border: 1px solid var(--border-color);
                color: white;
                border-radius: 4px;
                padding: 4px 6px;
                font-size: 11px;
                outline: none;
                box-sizing: border-box;
            }
            
            .btn-search {
                background: var(--accent-blue);
                border: none;
                color: white;
                border-radius: 4px;
                padding: 0 8px;
                cursor: pointer;
                flex-shrink: 0;
                font-size: 12px;
            }

            .nav-header {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 10px;
                padding: 0 2px;
            }
            .nav-label {
                font-size: 9px;
                color: var(--text-secondary);
                text-transform: uppercase;
                font-weight: bold;
            }
            .btn-gear {
                background: none;
                border: none;
                color: var(--text-secondary);
                cursor: pointer;
                font-size: 12px;
                transition: 0.2s;
                padding: 0;
            }
            .btn-gear.active {
                color: var(--accent-blue);
                transform: rotate(45deg);
            }
            #editForm {
                display: none;
                flex-direction: column;
                gap: 6px;
                padding: 8px;
                background: #1c1c1e;
                border-radius: 6px;
                margin-bottom: 10px;
                border: 1px solid var(--accent-blue);
                width: 100%;
                box-sizing: border-box;
            }
            #editForm input {
                width: 100%;
                background: #2c2c2e;
                border: 1px solid var(--border-color);
                color: white;
                padding: 6px;
                border-radius: 3px;
                font-size: 10px;
                outline: none;
                box-sizing: border-box;
            }
            .btn-save {
                width: 100%;
                background: var(--accent-blue);
                border: none;
                color: white;
                padding: 6px;
                border-radius: 3px;
                cursor: pointer;
                font-size: 10px;
                font-weight: bold;
                box-sizing: border-box;
            }
            .sync-group {
                display: flex;
                gap: 4px;
                margin-top: 4px;
            }
            .btn-sync {
                flex: 1;
                background: var(--glass-bg);
                border: 1px solid var(--border-color);
                color: var(--text-secondary);
                padding: 4px;
                border-radius: 3px;
                cursor: pointer;
                font-size: 9px;
            }
            .btn-sync:hover {
                background: rgba(255,255,255,0.1);
                color: white;
            }

            .bookmark-list {
                display: flex;
                flex-direction: column;
                gap: 2px;
                overflow-y: auto;
                flex-grow: 1;
                padding-bottom: 50px;
                scrollbar-width: none;
                width: 100%;
            }
            .bookmark-item {
                padding: 4px 10px;
                border-radius: 6px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: space-between;
                font-size: 12px;
                color: var(--text-secondary);
                background: rgba(255, 255, 255, 0.02);
                user-select: none;
            }
            .bookmark-item.active {
                background: var(--accent-blue);
                color: white;
                font-weight: 600;
            }
            .bookmark-item.editing-now {
                border: 1px dashed var(--accent-blue);
                background: rgba(0, 122, 255, 0.1);
            }
            .del-btn {
                color: var(--accent-red);
                font-weight: 900;
                font-size: 16px;
                margin-left: 8px;
                cursor: pointer;
                padding: 0px 4px;
            }
            .sortable-ghost {
                opacity: 0.3;
                background: var(--accent-blue) !important;
            }

            .floating-title {
                position: absolute;
                top: 15px;
                left: 50%;
                transform: translateX(-50%);
                z-index: 1000;
                border-radius: 30px;
                box-shadow: 0 8px 25px rgba(217, 4, 41, 0.5);
                border: 1px solid rgba(255, 255, 255, 0.2);
                min-width: 350px;
                display: flex;
                align-items: center;
                justify-content: center;
                pointer-events: none;
            }

            .floating-title a {
                background: var(--accent-red);
                color: white;
                text-decoration: none;
                font-size: 20px;
                font-weight: 800;
                padding: 6px 25px;
                display: block;
                width: 100%;
                text-align: center;
                border-radius: 30px;
                pointer-events: auto;
            }

            /* 1x4 Î™®ÎìúÏóêÏÑú Ï†úÎ™© ÌÅ¨Í∏∞ */
            .split-horizontal .floating-title {
                min-width: auto;
                top: 8px;
            }

            .split-horizontal .floating-title a {
                font-size: 20px;
                padding: 6px 25px;
                font-weight: 800;
            }

            /* 2x2 Î™®ÎìúÏóêÏÑúÎßå Ï†úÎ™© ÌÅ¨Í∏∞ ÏïΩÍ∞Ñ Ï∂ïÏÜå */
            .split-grid .floating-title {
                min-width: auto;
                top: 8px;
            }

            .split-grid .floating-title a {
                font-size: 15.4px;
                padding: 5px 15px;
                font-weight: 800;
            }

            .main-view {
                flex-grow: 1;
                display: flex;
                flex-direction: column;
                background: #000;
                position: relative;
            }
            .top-bar {
                height: 42px;
                background: var(--sidebar-bg);
                border-bottom: 1px solid var(--border-color);
                display: flex;
                align-items: center;
                justify-content: space-between;
                padding: 0 15px;
            }
            .toolbar-group {
                display: flex;
                align-items: center;
                gap: 12px;
            }
            .input-mini {
                width: 32px;
                background: #2c2c2e;
                border: 1px solid var(--border-color);
                color: white;
                border-radius: 3px;
                padding: 2px;
                text-align: center;
                outline: none;
                font-size: 10px;
            }
            .btn-top-action {
                background: var(--glass-bg);
                border: none;
                color: white;
                cursor: pointer;
                padding: 4px 8px;
                border-radius: 4px;
                font-size: 10px;
            }

            .btn-toggle {
                font-size: 16px;
                margin-right: 12px;
                background: none;
                border: none;
                color: white;
                cursor: pointer;
                padding: 0;
            }

            /* ÌôîÎ©¥ Î∂ÑÌï† Í¥ÄÎ†® Ïä§ÌÉÄÏùº */
            .frame-wrap {
                flex-grow: 1;
                margin: 10px;
                border-radius: 12px;
                overflow: hidden;
                position: relative;
                border: 1px solid var(--border-color);
                background: #ffffff;
                display: flex;
            }

            /* Î∂ÑÌï† Î™®ÎìúÎ≥Ñ Î†àÏù¥ÏïÑÏõÉ */
            .frame-wrap.split-horizontal {
                flex-direction: row;
            }

            .frame-wrap.split2 {
                flex-direction: row;
            }

            .frame-wrap.split3 {
                flex-direction: row;
            }

            .frame-wrap.split-vertical2 {
                flex-direction: column;
            }

            .frame-wrap.split-grid {
                flex-wrap: wrap;
            }

            .frame-container {
                position: relative;
                background: #ffffff;
                overflow: hidden;
                transition: box-shadow 0.3s;
            }

            /* ÌîÑÎ†àÏûÑ ÏÑ†ÌÉùÏùÑ ÏúÑÌïú ÌÅ¥Î¶≠ ÏòÅÏó≠ */
            .frame-selector {
                position: absolute;
                top: 10px;
                left: 10px;
                width: 30px;
                height: 30px;
                background: rgba(10, 132, 255, 0.3);
                border: 2px solid var(--accent-blue);
                border-radius: 50%;
                z-index: 999;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 14px;
                font-weight: bold;
                color: white;
                transition: all 0.2s;
            }

            .frame-selector:hover {
                background: rgba(10, 132, 255, 0.6);
                transform: scale(1.1);
            }

            .frame-container.selected .frame-selector {
                background: var(--accent-blue);
            }

            /* ÌîÑÎ†àÏûÑ ÏÑ∏Ìä∏ Ï†ÑÌôò Î≤ÑÌäº */
            .frame-set-toggle {
                position: absolute;
                top: 10px;
                right: 10px;
                background: rgba(48, 209, 88, 0.3);
                border: 2px solid var(--accent-green);
                color: white;
                padding: 6px 14px;
                border-radius: 20px;
                font-size: 11px;
                font-weight: bold;
                cursor: pointer;
                z-index: 999;
                transition: all 0.2s;
                display: flex;
                align-items: center;
                gap: 4px;
            }

            .frame-set-toggle:hover {
                background: rgba(48, 209, 88, 0.6);
                transform: scale(1.05);
            }

            .frame-set-toggle.active {
                background: var(--accent-green);
                box-shadow: 0 0 12px rgba(48, 209, 88, 0.6);
            }

            /* Îã®Ïùº Î™®ÎìúÏóêÏÑúÎäî ÏÑ†ÌÉù Î≤ÑÌäº Ïà®ÍπÄ */
            .split-single .frame-selector {
                display: none;
            }

            /* Îã®Ïùº Î™®Îìú */
            .frame-wrap.split-single .frame-container {
                width: 100%;
                height: 100%;
            }

            /* ÏÑ∏Î°ú 2Î∂ÑÌï† (1x2) */
            .frame-wrap.split2 .frame-container {
                width: 50%;
                height: 100%;
            }

            /* ÏÑ∏Î°ú 3Î∂ÑÌï† (1x3) */
            .frame-wrap.split3 .frame-container {
                width: 33.333%;
                height: 100%;
            }

            /* ÏÑ∏Î°ú 4Î∂ÑÌï† (1x4) */
            .frame-wrap.split-horizontal .frame-container {
                width: 25%;
                height: 100%;
            }

            /* Í∞ÄÎ°ú 2Î∂ÑÌï† (2x1) */
            .frame-wrap.split-vertical2 .frame-container {
                width: 100%;
                height: 50%;
            }

            /* 2x2 Í∑∏Î¶¨Îìú */
            .frame-wrap.split-grid .frame-container {
                width: 50%;
                height: 50%;
            }

            /* Î¶¨ÏÇ¨Ïù¥Ï†Ä Î∞î */
            .resizer {
                background: var(--divider-color);
                position: absolute;
                z-index: 10;
            }

            .resizer:hover {
                background: #ff8c5a;
            }

            .resizer.horizontal {
                width: 100%;
                height: 4px;
                cursor: row-resize;
                left: 0;
            }

            .resizer.vertical {
                width: 4px;
                height: 100%;
                cursor: col-resize;
                top: 0;
            }

            .resizer.dragging {
                background: #ffa366;
            }

            iframe {
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                border: none;
                transition: filter 0.3s ease;
            }

            /* Îã§ÌÅ¨Î™®Îìú ÌïÑÌÑ∞ */
            iframe.dark-mode {
    filter: grayscale(0) invert(1) contrast(0.85) brightness(1.2);
}




            /* Îã§ÌÅ¨Î™®Îìú Î∞∞Í≤Ω Ï°∞Ï†ï */
            .frame-container.dark-mode {
                background: #0a0a0a;
            }

            /* Î∂ÑÌï† Î™®Îìú Î≤ÑÌäº Ïä§ÌÉÄÏùº */
            .split-controls {
                display: flex;
                gap: 8px;
                align-items: center;
                border-left: 1px solid var(--border-color);
                padding-left: 12px;
                margin-left: 12px;
                position: relative;
            }

            .btn-split-current {
                background: var(--accent-blue);
                border: 1px solid var(--accent-blue);
                color: white;
                cursor: pointer;
                padding: 4px 12px;
                border-radius: 4px;
                font-size: 10px;
                font-weight: 600;
                position: relative;
            }

            .btn-split-current:hover {
                background: #0070e0;
            }

            .split-dropdown {
                display: none;
                position: absolute;
                top: 100%;
                left: 0;
                margin-top: 4px;
                background: var(--sidebar-bg);
                border: 1px solid var(--border-color);
                border-radius: 6px;
                padding: 4px;
                z-index: 10000;
                min-width: 80px;
                box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            }

            .split-dropdown.show {
                display: flex;
                flex-direction: column;
                gap: 2px;
            }

            .split-dropdown-item {
                background: var(--glass-bg);
                border: 1px solid var(--border-color);
                color: white;
                cursor: pointer;
                padding: 6px 12px;
                border-radius: 4px;
                font-size: 10px;
                text-align: center;
                transition: all 0.2s;
            }

            .split-dropdown-item:hover {
                background: rgba(255, 255, 255, 0.15);
                border-color: var(--accent-blue);
            }

            .split-dropdown-item.active {
                background: var(--accent-blue);
                border-color: var(--accent-blue);
            }

            .btn-split {
                background: var(--glass-bg);
                border: 1px solid var(--border-color);
                color: white;
                cursor: pointer;
                padding: 4px 10px;
                border-radius: 4px;
                font-size: 10px;
                transition: all 0.2s;
            }

            .btn-split.active {
                background: var(--accent-blue);
                border-color: var(--accent-blue);
            }

            .btn-split:hover {
                background: rgba(255, 255, 255, 0.1);
            }

            /* ÎÇ†Ïßú/ÏãúÍ∞Ñ ÌëúÏãú Ïä§ÌÉÄÏùº */
            .datetime-display {
                display: flex;
                align-items: center;
                gap: 8px;
                padding: 6px 14px;
                background: linear-gradient(135deg, rgba(10, 132, 255, 0.1), rgba(48, 209, 88, 0.1));
                border: 1px solid rgba(10, 132, 255, 0.3);
                border-radius: 8px;
                font-size: 11px;
                font-weight: 600;
                color: var(--text-primary);
                letter-spacing: -0.3px;
                box-shadow: 0 2px 8px rgba(10, 132, 255, 0.15);
                position: relative;
                overflow: hidden;
            }

            .datetime-display::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
                animation: shimmer 3s infinite;
            }

            @keyframes shimmer {
                0% { left: -100%; }
                100% { left: 100%; }
            }

            .datetime-icon {
                font-size: 13px;
                filter: drop-shadow(0 0 3px rgba(10, 132, 255, 0.5));
            }

            .datetime-text {
                display: flex;
                flex-direction: column;
                gap: 1px;
            }

            .datetime-date {
                font-size: 11px;
                opacity: 0.95;
            }

            /* ‚òÖ ÏãúÍ∞Ñ ÌÖçÏä§Ìä∏ ÏÉâÏÉÅ Î≥ÄÍ≤Ω: Î∞ùÍ≥† Ïûò Î≥¥Ïù¥Í≤å */
            .datetime-time {
                font-size: 10px;
                opacity: 1;
                color: #7ee8a2;
                font-weight: 700;
            }

            /* ‚òÖ Îã§Ïùå Î∂ÅÎßàÌÅ¨ Î≤ÑÌäº */
            #nextBookmarkBtn {
                background: rgba(255, 255, 255, 0.08);
                backdrop-filter: blur(15px);
                border: 1px solid rgba(255, 255, 255, 0.2);
                color: var(--text-primary);
                padding: 5px 12px;
                border-radius: 8px;
                font-size: 11px;
                font-weight: 700;
                cursor: pointer;
                display: flex;
                align-items: center;
                gap: 6px;
                transition: all 0.2s;
                white-space: nowrap;
            }

            #nextBookmarkBtn:hover {
                background: rgba(48, 209, 88, 0.2);
                border-color: var(--accent-green);
                color: var(--accent-green);
                transform: scale(1.05);
            }

            #nextBookmarkBtn:active {
                transform: scale(0.97);
            }
        </style>
    </head>
    <body>
        <div class="sidebar">
            <div class="brand-title">PRO HUB v5.5</div>
            
            <!-- Ï°∞Í±¥ Í≤ÄÏÉâ ÏòÅÏó≠ -->
            <div class="search-area">
                <select id="searchTarget" class="search-select">
                    <option value="total">Ìé®ÏΩî</option>
                    <option value="best">Ìè¨ÌÖê</option>
                    <option value="soccer">Ìï¥Ï∂ï</option>
                    <option value="humor">Ïú†Î®∏</option>
                    <option value="news">Ï∂ïÏÜåÌÜµ</option>
                    <option value="url">URL</option>
                </select>
                <div class="search-input-group">
                    <input type="text" id="searchKeyword" class="search-input" placeholder="Í≤ÄÏÉâÏñ¥ ÏûÖÎ†•..." onkeypress="if (event.key === 'Enter') executeSearch();" />
                    <button class="btn-search" onclick="executeSearch()">üîç</button>
                </div>
            </div>
            
            <div class="nav-header">
                <span class="nav-label">FAV</span>
                <button id="gearBtn" class="btn-gear" onclick="toggleEditMode()">‚öôÔ∏è</button>
            </div>
            <div id="editForm">
                <input type="text" id="pcBmName" placeholder="Name" />
                <input type="text" id="pcBmUrl" placeholder="URL" />
                <button class="btn-save" onclick="handleBookmarkSubmit()">Save</button>
                <div class="sync-group">
                    <button class="btn-sync" onclick="exportBookmarks()">Export</button>
                    <button class="btn-sync" onclick="importBookmarks()">Import</button>
                </div>
            </div>
            <div class="bookmark-list" id="pcSortableList"></div>
        </div>

        <main class="main-view">
            <header class="top-bar">
                <div style="display: flex; align-items: center; margin-right: auto">
                    <button class="btn-toggle" onclick="toggleSidebar()">‚ò∞</button>
                    <button id="modeSwitcher" onclick="goToMobileSite()"><span>üì±</span> <span>Mobile</span></button>
                    <button id="darkModeBtn" onclick="toggleDarkMode()"><span>üåô</span> <span>Dark</span></button>
                    <button id="noteBtn" onclick="openNote()"><span>üìù</span> <span>Note</span></button>
                </div>

                <div class="toolbar-group">
                    <div class="split-controls">
                        <button class="btn-split-current" onclick="toggleSplitDropdown()">1x1 ‚ñº</button>
                        <div class="split-dropdown" id="splitDropdown">
                            <div class="split-dropdown-item active" onclick="setSplitMode('single')">1x1</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('split2')">1x2</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('split3')">1x3</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('horizontal')">1x4</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('vertical2')">2x1</div>
                            <div class="split-dropdown-item" onclick="setSplitMode('grid')">2x2</div>
                        </div>
                    </div>
                    <div class="ctrl-item" style="font-size: 10px; color: var(--text-secondary)"><span>CROP</span><input type="number" id="pcCropValue" class="input-mini" value="0" oninput="applyPcCrop()" /></div>
                    <div class="ctrl-item" style="border-left: 1px solid var(--border-color); padding-left: 10px; display: flex; gap: 5px">
                        <button id="modeToggleBtn" class="btn-top-action" onclick="toggleCycleMode()">All</button>
                        <input type="number" id="cycleInterval" class="input-mini" value="10" />
                        <button id="cycleBtn" class="btn-top-action" onclick="toggleCycle()">Go</button>
                    </div>
                    <button onclick="smartRefresh()" class="btn-top-action">‚Üª</button>
                    <!-- ‚òÖ Îã§Ïùå Î∂ÅÎßàÌÅ¨ Î≤ÑÌäº -->
                    <button id="nextBookmarkBtn" onclick="loadNextBookmark()" title="Îã§Ïùå Î∂ÅÎßàÌÅ¨Î°ú Ïù¥Îèô">‚ñ∂</button>
                    <div class="datetime-display" id="datetimeDisplay">
                        <span class="datetime-icon">üïê</span>
                        <div class="datetime-text">
                            <span class="datetime-date" id="dateText">-</span>
                            <span class="datetime-time" id="timeText">-</span>
                        </div>
                    </div>
                </div>
            </header>

            <div class="frame-wrap split-single" id="frameWrap">
                <!-- ÌîÑÎ†àÏûÑÎì§Ïù¥ ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
            </div>
        </main>

        <script>
            let currentUrl = 'https://m.fmkorea.com/',
                isEditMode = false,
                editingIndex = -1;
            let cycleIntervalTimer = null,
                cycleMode = 'all',
                sortableInstance = null;

            // Îã§ÌÅ¨Î™®Îìú ÏÉÅÌÉú
            let isDarkMode = localStorage.getItem('prohub_darkmode') === 'true';

            // ÎÇ†Ïßú/ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏ Ìï®Ïàò
            function updateDateTime() {
                const now = new Date();
                const month = now.getMonth() + 1;
                const date = now.getDate();
                const days = ['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'];
                const day = days[now.getDay()];
                
                let hours = now.getHours();
                const minutes = now.getMinutes();
                const ampm = hours >= 12 ? 'Ïò§ÌõÑ' : 'Ïò§Ï†Ñ';
                hours = hours % 12 || 12;
                
                const dateText = `${month}Ïõî ${date}Ïùº (${day})`;
                const timeText = `${ampm} ${hours}Ïãú ${minutes.toString().padStart(2, '0')}Î∂Ñ`;
                
                document.getElementById('dateText').textContent = dateText;
                document.getElementById('timeText').textContent = timeText;
            }

            // 1Ï¥àÎßàÎã§ ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
            setInterval(updateDateTime, 1000);

            // ÌôîÎ©¥ Î∂ÑÌï† Í¥ÄÎ†® Î≥ÄÏàò
            let splitMode = 'single';
            let selectedFrameIndex = 0;
            
            // 8Í∞úÏùò ÌîÑÎ†àÏûÑ URLÍ≥º Ï†úÎ™© (ÏµúÎåÄ 4Î∂ÑÌï† x 2ÏÑ∏Ìä∏)
            let frameUrls = ['https://m.fmkorea.com/', '', '', '', '', '', '', ''];
            let frameTitles = ['Ìè¨ÌÖê', '', '', '', '', '', '', ''];
            
            // ÌòÑÏû¨ ÌôúÏÑ±ÌôîÎêú ÌîÑÎ†àÏûÑ ÏÑ∏Ìä∏ (0 ÎòêÎäî 1)
            let activeFrameSet = 0;
            
            let resizeState = {
                isResizing: false,
                startPos: 0,
                startSize: 0,
                targetIndex: -1,
                direction: ''
            };

            // ÌîÑÎ†àÏûÑ ÌÅ¨Í∏∞ ÎπÑÏú®
            let frameSizes = {
                split2: [50, 50],
                split3: [33.333, 33.333, 33.334],
                horizontal: [25, 25, 25, 25],
                vertical2: [50, 50],
                grid: [50, 50, 50, 50]
            };

            // ‚òÖ Îã§Ïùå Î∂ÅÎßàÌÅ¨ Î°úÎìú Ìï®Ïàò
            function loadNextBookmark() {
                const bms = JSON.parse(localStorage.getItem('myHubBookmarks')) || [];
                if (bms.length === 0) return;

                // ÌòÑÏû¨ URL Í∏∞Ï§ÄÏúºÎ°ú Îã§Ïùå Î∂ÅÎßàÌÅ¨ Ï∞æÍ∏∞
                let idx = bms.findIndex(bm => bm.url === currentUrl);
                let next = (idx + 1) % bms.length;
                loadSite(bms[next].url, bms[next].name);
            }

            // Îã§ÌÅ¨Î™®Îìú ÌÜ†Í∏Ä Ìï®Ïàò
            function toggleDarkMode() {
                isDarkMode = !isDarkMode;
                localStorage.setItem('prohub_darkmode', isDarkMode);
                applyDarkMode();
                
                const btn = document.getElementById('darkModeBtn');
                if (isDarkMode) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            }

            // Îã§ÌÅ¨Î™®Îìú Ï†ÅÏö© Ìï®Ïàò
            function applyDarkMode() {
                if (splitMode === 'single') {
                    const frame = document.getElementById('frame-0');
                    const container = document.getElementById('container-0');
                    if (frame) {
                        if (isDarkMode) {
                            frame.classList.add('dark-mode');
                            if (container) container.classList.add('dark-mode');
                        } else {
                            frame.classList.remove('dark-mode');
                            if (container) container.classList.remove('dark-mode');
                        }
                    }
                } else {
                    const maxFrames = splitMode === 'split2' || splitMode === 'vertical2' ? 2 : splitMode === 'split3' ? 3 : 4;
                    for (let i = 0; i < maxFrames; i++) {
                        const frame = document.getElementById(`frame-${i}`);
                        const container = document.getElementById(`container-${i}`);
                        if (frame) {
                            if (isDarkMode) {
                                frame.classList.add('dark-mode');
                                if (container) container.classList.add('dark-mode');
                            } else {
                                frame.classList.remove('dark-mode');
                                if (container) container.classList.remove('dark-mode');
                            }
                        }
                    }
                }
            }

            // Ïä§ÌÅ¨Î°§ ÏúÑÏπò Ï†ÄÏû• Ìï®Ïàò
            function saveScrollPosition(frameIndex) {
                const url = frameUrls[frameIndex];
                if (!url) return;
                
                const frame = document.getElementById(`frame-${frameIndex % getMaxFrames()}`);
                if (!frame) return;
                
                try {
                    const scrollY = frame.contentWindow.scrollY || frame.contentWindow.pageYOffset || 0;
                    const scrollData = JSON.parse(localStorage.getItem('frameScrollPositions')) || {};
                    scrollData[url] = scrollY;
                    localStorage.setItem('frameScrollPositions', JSON.stringify(scrollData));
                } catch (e) {
                    // Cross-origin Ï†úÌïúÏúºÎ°ú Ïã§Ìå®Ìï† Ïàò ÏûàÏùå
                }
            }

            // Ïä§ÌÅ¨Î°§ ÏúÑÏπò Î≥µÏõê Ìï®Ïàò
            function restoreScrollPosition(frameIndex) {
                const url = frameUrls[frameIndex];
                if (!url) return;
                
                const frame = document.getElementById(`frame-${frameIndex % getMaxFrames()}`);
                if (!frame) return;
                
                try {
                    const scrollData = JSON.parse(localStorage.getItem('frameScrollPositions')) || {};
                    const scrollY = scrollData[url];
                    
                    if (scrollY) {
                        setTimeout(() => {
                            try {
                                frame.contentWindow.scrollTo(0, scrollY);
                            } catch (e) {}
                        }, 500);
                    }
                } catch (e) {
                    // Cross-origin Ï†úÌïúÏúºÎ°ú Ïã§Ìå®Ìï† Ïàò ÏûàÏùå
                }
            }

            // ÌòÑÏû¨ Î∂ÑÌï† Î™®ÎìúÏùò ÏµúÎåÄ ÌîÑÎ†àÏûÑ Ïàò Î∞òÌôò
            function getMaxFrames() {
                if (splitMode === 'single') return 1;
                if (splitMode === 'split2' || splitMode === 'vertical2') return 2;
                if (splitMode === 'split3') return 3;
                return 4;
            }

            // Ï†ÑÏ≤¥ Ïä¨Î°Ø Ïàò Î∞òÌôò (ÏÑ∏Ìä∏ 2Í∞ú Ìï©ÏÇ∞)
            function getTotalSlots() {
                return getMaxFrames() * 2;
            }

            // Ï£ºÍ∏∞Ï†ÅÏúºÎ°ú Ïä§ÌÅ¨Î°§ ÏúÑÏπò Ï†ÄÏû•
            setInterval(() => {
                if (splitMode === 'single') {
                    saveScrollPosition(0);
                } else {
                    const maxFrames = getMaxFrames();
                    const offset = activeFrameSet * maxFrames;
                    for (let i = 0; i < maxFrames; i++) {
                        saveScrollPosition(offset + i);
                    }
                }
            }, 2000);

            // Î∂ÅÎßàÌÅ¨ Î°úÎìú ÌõÑ Îã§Ïùå ÌîÑÎ†àÏûÑÏúºÎ°ú ÏûêÎèô Ïù¥Îèô (Î∂ÑÌï† Î™®Îìú Ï†ÑÏö©)
            function advanceToNextFrame() {
                const maxFrames = getMaxFrames();
                const totalSlots = getTotalSlots();
                // ÌòÑÏû¨ Ïã§Ï†ú Ïä¨Î°Ø Î≤àÌò∏ (0-based)
                const currentRealIndex = activeFrameSet * maxFrames + selectedFrameIndex;
                // Îã§Ïùå Ïä¨Î°Ø Î≤àÌò∏ (ÏàúÌôò)
                const nextRealIndex = (currentRealIndex + 1) % totalSlots;
                // Îã§Ïùå Ïä¨Î°ØÏù¥ ÏÜçÌïòÎäî ÏÑ∏Ìä∏ÏôÄ ÌîÑÎ†àÏûÑ ÎÇ¥ Ïù∏Îç±Ïä§ Í≥ÑÏÇ∞
                const nextSet = Math.floor(nextRealIndex / maxFrames);
                const nextFrameInSet = nextRealIndex % maxFrames;

                if (nextSet !== activeFrameSet) {
                    // ÏÑ∏Ìä∏Í∞Ä Î∞îÎÄú ‚Üí ÏÑ∏Ìä∏ Ï†ÑÌôò ÌõÑ ÌîÑÎ†àÏûÑ ÏÑ†ÌÉù
                    activeFrameSet = nextSet;
                    selectedFrameIndex = nextFrameInSet;
                    switchFrameSet();
                } else {
                    // Í∞ôÏùÄ ÏÑ∏Ìä∏ ÎÇ¥ÏóêÏÑú Îã§Ïùå ÌîÑÎ†àÏûÑÏúºÎ°ú Ïù¥Îèô
                    selectedFrameIndex = nextFrameInSet;
                    updateFrameSelection();
                }
            }

            // ÎìúÎ°≠Îã§Ïö¥ ÌÜ†Í∏Ä
            function toggleSplitDropdown() {
                const dropdown = document.getElementById('splitDropdown');
                dropdown.classList.toggle('show');
            }

            // ÎìúÎ°≠Îã§Ïö¥ Ïô∏Î∂Ä ÌÅ¥Î¶≠ Ïãú Îã´Í∏∞
            document.addEventListener('click', function(e) {
                const dropdown = document.getElementById('splitDropdown');
                const button = document.querySelector('.btn-split-current');
                if (dropdown && button && !dropdown.contains(e.target) && !button.contains(e.target)) {
                    dropdown.classList.remove('show');
                }
            });

            function toggleSidebar() {
                document.body.classList.toggle('collapsed');
            }

            function openNote() {
                const prevUrl = currentUrl;
                const prevTitle = document.getElementById('standardTitle') ? document.getElementById('standardTitle').innerText.replace(/'/g, "\\'") : 'Ìè¨ÌÖê';

                if (splitMode !== 'single') {
                    setSplitMode('single');
                }

                const frame = document.getElementById('frame-0');
                const title = document.getElementById('title-0');
                if (title) title.innerText = 'Personal Note';

                const savedNote = localStorage.getItem('myHubNote') || '';
                frame.style.opacity = '0';

                // ÎÖ∏Ìä∏ Î™®ÎìúÏóêÏÑúÎäî Îã§ÌÅ¨Î™®Îìú ÌïÑÌÑ∞ Ï†úÍ±∞
                frame.classList.remove('dark-mode');

                frame.srcdoc = `
            <html>
            <head>
                <style>
                    body { background: #f8f9fa; color: #0f1419; font-family: -apple-system, sans-serif; display: flex; flex-direction: column; height: 100vh; margin: 0; padding: 60px 20px 20px; box-sizing: border-box; }
                    .note-container { flex-grow: 1; display: flex; flex-direction: column; gap: 15px; max-width: 800px; margin: 0 auto; width: 100%; animation: fadeIn 0.4s ease; }
                    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
                    textarea { flex-grow: 1; background: #ffffff; border: 1px solid #e1e8ed; border-radius: 16px; color: #0f1419; padding: 25px; font-size: 16px; line-height: 1.6; outline: none; resize: none; transition: 0.3s; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
                    textarea:focus { border-color: #0a84ff; box-shadow: 0 4px 20px rgba(10, 132, 255, 0.15); }
                    .actions { display: flex; justify-content: flex-end; gap: 12px; margin-top: 10px; }
                    button { padding: 12px 28px; border-radius: 30px; font-weight: 700; cursor: pointer; border: none; transition: 0.2s; font-size: 14px; }
                    .btn-save { background: #0a84ff; color: white; box-shadow: 0 4px 10px rgba(10, 132, 255, 0.3); }
                    .btn-save:hover:not(:disabled) { background: #0070e0; transform: scale(1.03); }
                    .btn-save:disabled { background: #d1d5db; color: #9ca3af; box-shadow: none; cursor: not-allowed; opacity: 0.6; }
                    .btn-close { background: #f0f3f4; color: #536471; }
                    .btn-close:hover { background: #e2e5e7; }
                </style>
            </head>
            <body>
                <div class="note-container">
                    <textarea id="noteArea" placeholder="ÎÇòÎßåÏùò ÏûëÏóÖ Î©îÎ™®Î•º ÎÇ®Í≤®Î≥¥ÏÑ∏Ïöî...">${savedNote}</textarea>
                    <div class="actions">
                        <button class="btn-close" onclick="window.parent.loadSite('${prevUrl}', '${prevTitle}')">Back</button>
                        <button class="btn-save" id="saveBtn" onclick="saveNote()" disabled>Save Note</button>
                    </div>
                </div>
                <script>
                    let initialValue = document.getElementById('noteArea').value;
                    const saveBtn = document.getElementById('saveBtn');
                    
                    document.getElementById('noteArea').addEventListener('input', function() {
                        const currentValue = this.value;
                        if (currentValue !== initialValue) {
                            saveBtn.disabled = false;
                        } else {
                            saveBtn.disabled = true;
                        }
                    });
                    
                    document.addEventListener('keydown', function(e) {
                        if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                            e.preventDefault();
                            if (!saveBtn.disabled) {
                                saveNote();
                            }
                        }
                    });
                    
                    function saveNote() {
                        const val = document.getElementById('noteArea').value;
                        localStorage.setItem('myHubNote', val);
                        initialValue = val;
                        saveBtn.disabled = true;
                    }
                <\/script>
            </body>
            </html>
        `;

                setTimeout(() => {
                    frame.style.opacity = '1';
                }, 50);
            }

            function initSortable() {
                const el = document.getElementById('pcSortableList');
                if (sortableInstance) sortableInstance.destroy();
                sortableInstance = new Sortable(el, {
                    animation: 350,
                    disabled: !isEditMode,
                    ghostClass: 'sortable-ghost',
                    forceFallback: true,
                    filter: '.del-btn',
                    onEnd: function () {
                        const items = el.querySelectorAll('.bookmark-item');
                        const newOrder = Array.from(items).map((item) => ({ name: item.dataset.name, url: item.dataset.url }));
                        localStorage.setItem('myHubBookmarks', JSON.stringify(newOrder));
                    },
                });
            }

            function renderBookmarks() {
                const container = document.getElementById('pcSortableList'),
                    bms = JSON.parse(localStorage.getItem('myHubBookmarks')) || [];
                container.innerHTML = bms
                    .map((bm, index) => {
                        const isActive = !isEditMode && bm.url === currentUrl ? 'active' : '';
                        const isEditing = editingIndex === index ? 'editing-now' : '';
                        return `<div class="bookmark-item ${isActive} ${isEditing}" onclick="handleItemClick(${index}, event)" data-name="${bm.name}" data-url="${bm.url}">
                        <span>${bm.name}</span>${isEditMode ? `<div class="del-btn" onclick="deleteBookmark(${index}, event)">√ó</div>` : ''}
                    </div>`;
                    })
                    .join('');
                initSortable();
            }

            function handleItemClick(idx, e) {
                if (e.target.classList.contains('del-btn')) return;
                const bms = JSON.parse(localStorage.getItem('myHubBookmarks'));
                if (isEditMode) {
                    if (editingIndex === idx) {
                        editingIndex = -1;
                        document.getElementById('pcBmName').value = '';
                        document.getElementById('pcBmUrl').value = '';
                    } else {
                        editingIndex = idx;
                        document.getElementById('pcBmName').value = bms[idx].name;
                        document.getElementById('pcBmUrl').value = bms[idx].url.replace(/^https?:\/\//i, '');
                    }
                    renderBookmarks();
                } else {
                    loadSite(bms[idx].url, bms[idx].name);
                }
            }

            function deleteBookmark(idx, e) {
                e.stopPropagation();
                if (!confirm('Ï†ïÎßê ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?')) return;
                let bms = JSON.parse(localStorage.getItem('myHubBookmarks'));
                bms.splice(idx, 1);
                localStorage.setItem('myHubBookmarks', JSON.stringify(bms));
                if (editingIndex === idx) editingIndex = -1;
                renderBookmarks();
            }

            function toggleEditMode() {
                isEditMode = !isEditMode;
                document.getElementById('gearBtn').classList.toggle('active', isEditMode);
                document.getElementById('editForm').style.display = isEditMode ? 'flex' : 'none';
                if (!isEditMode) {
                    editingIndex = -1;
                    document.getElementById('pcBmName').value = '';
                    document.getElementById('pcBmUrl').value = '';
                }
                renderBookmarks();
            }

            function handleBookmarkSubmit() {
                const name = document.getElementById('pcBmName').value.trim();
                let url = document.getElementById('pcBmUrl').value.trim();
                if (!name || !url) return;
                if (!/^https?:\/\//i.test(url)) url = 'https://' + url;
                let bms = JSON.parse(localStorage.getItem('myHubBookmarks')) || [];
                if (editingIndex > -1) bms[editingIndex] = { name, url };
                else bms.push({ name, url });
                localStorage.setItem('myHubBookmarks', JSON.stringify(bms));
                editingIndex = -1;
                document.getElementById('pcBmName').value = '';
                document.getElementById('pcBmUrl').value = '';
                renderBookmarks();
            }

            // ÌîÑÎ†àÏûÑ ÏÑ†ÌÉù Ìï®Ïàò
            function selectFrame(index) {
                if (splitMode === 'single') return;
                selectedFrameIndex = index;
                updateFrameSelection();
            }

            // ÌîÑÎ†àÏûÑ ÏÑ∏Ìä∏ ÌÜ†Í∏Ä Ìï®Ïàò
            function toggleFrameSet() {
                if (splitMode === 'single') return;
                activeFrameSet = 1 - activeFrameSet;
                selectedFrameIndex = 0;
                switchFrameSet();
            }

            // ÌîÑÎ†àÏûÑ ÏÑ∏Ìä∏ Ï†ÑÌôò
            function switchFrameSet() {
                const maxFrames = getMaxFrames();
                const offset = activeFrameSet * maxFrames;
                
                // Î™®Îì† ÌîÑÎ†àÏûÑ Ï†ÄÏû•
                for (let i = 0; i < maxFrames; i++) {
                    const currentOffset = (1 - activeFrameSet) * maxFrames;
                    saveScrollPosition(currentOffset + i);
                }
                
                // ÌîÑÎ†àÏûÑ URL ÏóÖÎç∞Ïù¥Ìä∏
                for (let i = 0; i < maxFrames; i++) {
                    const frame = document.getElementById(`frame-${i}`);
                    const titleEl = document.getElementById(`title-${i}`);
                    const realIndex = offset + i;
                    
                    if (frame) {
                        if (frameUrls[realIndex]) {
                            frame.style.opacity = '0';
                            frame.src = frameUrls[realIndex];
                            
                            if (titleEl) {
                                titleEl.innerText = frameTitles[realIndex] || `ÌîÑÎ†àÏûÑ ${realIndex + 1}`;
                                titleEl.href = frameUrls[realIndex];
                            }
                            
                            frame.onload = ((index) => {
                                return () => {
                                    frame.style.opacity = '1';
                                    applyPcCrop();
                                    applyDarkMode();
                                    restoreScrollPosition(offset + index);
                                };
                            })(i);
                        } else {
                            frame.src = '';
                            if (titleEl) {
                                titleEl.innerText = `ÌîÑÎ†àÏûÑ ${realIndex + 1}`;
                                titleEl.href = '#';
                            }
                        }
                    }
                }
                
                // DOM Ïû¨Î†åÎçîÎ•º ÌÜµÌï¥ ÏÑ∏Ìä∏ ÌëúÏãúÏôÄ ÌîÑÎ†àÏûÑ ÏÑ†ÌÉùÏùÑ Ï†ïÌôïÌûà Ï†ÅÏö©
                renderFrames();
            }
            
            // ÌîÑÎ†àÏûÑ ÏÑ∏Ìä∏ ÌëúÏãú ÏóÖÎç∞Ïù¥Ìä∏ (Ï¢åÏ∏° ÏÉÅÎã®: ÌòÑÏû¨ Ïä¨Î°Ø Î≤àÌò∏ 1~8, ÏïÑÎûò: Î∞òÎåÄ ÏÑ∏Ìä∏ Î≤àÌò∏)
            function updateFrameSetDisplay() {
                const maxFrames = getMaxFrames();
                
                // Ï¢åÏ∏° ÏÉÅÎã® ÌîÑÎ†àÏûÑ Î≤àÌò∏: ÌòÑÏû¨ Î≥¥Îäî Ïä¨Î°Ø(1~4 ÎòêÎäî 5~8)
                document.querySelectorAll('.frame-container').forEach((container, i) => {
                    const realIndex = activeFrameSet * maxFrames + i;
                    const selector = container.querySelector('.frame-selector');
                    if (selector) selector.textContent = realIndex + 1;
                });
                
                // ÏïÑÎûò Î≤àÌò∏: Î∞òÎåÄ ÏÑ∏Ìä∏(1~4Ïùº Îïê 5~8, 5~8Ïùº Îïê 1~4)
                document.querySelectorAll('.frame-set-display').forEach((display, i) => {
                    const otherSetSlot = (1 - activeFrameSet) * maxFrames + i + 1;
                    display.textContent = `${otherSetSlot}`;
                });
                
                // ÏÑ∏Ìä∏ Ï†ÑÌôò Î≤ÑÌäº ÌÖçÏä§Ìä∏ ÏóÖÎç∞Ïù¥Ìä∏
                const toggleBtn = document.querySelector('.frame-set-toggle');
                if (toggleBtn) {
                    let text = '';
                    if (splitMode === 'split2' || splitMode === 'vertical2') {
                        text = activeFrameSet === 0 ? '1-2' : '3-4';
                    } else if (splitMode === 'split3') {
                        text = activeFrameSet === 0 ? '1-3' : '4-6';
                    } else {
                        text = activeFrameSet === 0 ? '1-4' : '5-8';
                    }
                    toggleBtn.innerHTML = `üîÑ ${text}`;
                }
            }

            // ÌîÑÎ†àÏûÑ ÏÑ†ÌÉù UI ÏóÖÎç∞Ïù¥Ìä∏
            function updateFrameSelection() {
                document.querySelectorAll('.frame-container').forEach((container, i) => {
                    if (i === selectedFrameIndex) {
                        container.classList.add('selected');
                    } else {
                        container.classList.remove('selected');
                    }
                });
                
                // ÏÑ∏Ìä∏ Ï†ÑÌôò Î≤ÑÌäº ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                const toggleBtn = document.querySelector('.frame-set-toggle');
                if (toggleBtn) {
                    if (activeFrameSet === 1) {
                        toggleBtn.classList.add('active');
                    } else {
                        toggleBtn.classList.remove('active');
                    }
                }
            }

            function loadSite(url, title) {
                if (splitMode === 'single') {
                    saveScrollPosition(0);
                    
                    currentUrl = url;
                    frameUrls[0] = url;
                    frameTitles[0] = title;
                    const frame = document.getElementById('frame-0');
                    const titleEl = document.getElementById('title-0');
                    
                    if (titleEl) {
                        titleEl.innerText = title;
                        titleEl.href = url;
                    }
                    
                    frame.style.opacity = '0';
                    frame.removeAttribute('srcdoc');
                    frame.src = url;
                    frame.onload = () => {
                        frame.style.opacity = '1';
                        applyPcCrop();
                        applyDarkMode();
                        restoreScrollPosition(0);
                    };
                } else {
                    const maxFrames = getMaxFrames();
                    const offset = activeFrameSet * maxFrames;
                    const realFrameIndex = offset + selectedFrameIndex;
                    
                    saveScrollPosition(realFrameIndex);
                    
                    frameUrls[realFrameIndex] = url;
                    frameTitles[realFrameIndex] = title;
                    
                    const frame = document.getElementById(`frame-${selectedFrameIndex}`);
                    const titleEl = document.getElementById(`title-${selectedFrameIndex}`);
                    
                    if (titleEl) {
                        titleEl.innerText = title;
                        titleEl.href = url;
                    }
                    
                    frame.style.opacity = '0';
                    frame.removeAttribute('srcdoc');
                    frame.src = url;
                    frame.onload = () => {
                        frame.style.opacity = '1';
                        applyPcCrop();
                        applyDarkMode();
                        restoreScrollPosition(realFrameIndex);
                    };

                    // Î∂ÅÎßàÌÅ¨ Î°úÎìú ÏôÑÎ£å ÌõÑ Îã§Ïùå ÌîÑÎ†àÏûÑÏúºÎ°ú ÏûêÎèô Ïù¥Îèô
                    advanceToNextFrame();
                }
                
                renderBookmarks();
            }

            function smartRefresh() {
                if (splitMode === 'single') {
                    saveScrollPosition(0);
                    const frame = document.getElementById('frame-0');
                    frame.src = currentUrl + (currentUrl.includes('?') ? '&' : '?') + 'r=' + Date.now();
                    frame.onload = () => {
                        applyPcCrop();
                        applyDarkMode();
                        restoreScrollPosition(0);
                    };
                } else {
                    const maxFrames = getMaxFrames();
                    const offset = activeFrameSet * maxFrames;
                    
                    for (let i = 0; i < maxFrames; i++) {
                        const frame = document.getElementById(`frame-${i}`);
                        const realIndex = offset + i;
                        
                        if (frameUrls[realIndex] && frame) {
                            saveScrollPosition(realIndex);
                            frame.src = frameUrls[realIndex] + (frameUrls[realIndex].includes('?') ? '&' : '?') + 'r=' + Date.now();
                            frame.onload = ((idx) => {
                                return () => {
                                    applyPcCrop();
                                    applyDarkMode();
                                    restoreScrollPosition(offset + idx);
                                };
                            })(i);
                        }
                    }
                }
            }

            function applyPcCrop() {
                const val = document.getElementById('pcCropValue').value || 0;
                
                if (splitMode === 'single') {
                    const frame = document.getElementById('frame-0');
                    if (frame) {
                        frame.style.top = `-${val}%`;
                        frame.style.height = `${100 + parseInt(val)}%`;
                    }
                } else {
                    const maxFrames = getMaxFrames();
                    for (let i = 0; i < maxFrames; i++) {
                        const frame = document.getElementById(`frame-${i}`);
                        if (frame) {
                            frame.style.top = `-${val}%`;
                            frame.style.height = `${100 + parseInt(val)}%`;
                        }
                    }
                }
            }

            function toggleCycleMode() {
                const btn = document.getElementById('modeToggleBtn');
                cycleMode = cycleMode === 'all' ? 'single' : 'all';
                btn.innerText = cycleMode === 'all' ? 'All' : 'One';
            }

            function toggleCycle() {
                const btn = document.getElementById('cycleBtn');
                if (cycleIntervalTimer) {
                    clearInterval(cycleIntervalTimer);
                    cycleIntervalTimer = null;
                    btn.innerText = 'Go';
                } else {
                    let sec = parseInt(document.getElementById('cycleInterval').value) || 10;
                    btn.innerText = 'Stop';
                    
                    if (splitMode === 'single') {
                        cycleIntervalTimer = setInterval(() => {
                            if (cycleMode === 'all') {
                                const bms = JSON.parse(localStorage.getItem('myHubBookmarks'));
                                let idx = bms.findIndex((bm) => bm.url === currentUrl);
                                let next = (idx + 1) % bms.length;
                                loadSite(bms[next].url, bms[next].name);
                            } else {
                                smartRefresh();
                            }
                        }, sec * 1000);
                    } else {
                        cycleIntervalTimer = setInterval(() => {
                            if (cycleMode === 'all') {
                                // All Î™®Îìú: ÌîÑÎ†àÏûÑ ÏÑ∏Ìä∏ Ï†ÑÌôò
                                activeFrameSet = 1 - activeFrameSet;
                                switchFrameSet();
                            } else {
                                // One Î™®Îìú: ÌòÑÏû¨ ÌîÑÎ†àÏûÑÎì§Îßå ÏÉàÎ°úÍ≥†Ïπ®
                                smartRefresh();
                            }
                        }, sec * 1000);
                    }
                }
            }

            function executeSearch() {
                const target = document.getElementById('searchTarget').value;
                const keyword = document.getElementById('searchKeyword').value.trim();
                
                if (!keyword) return;
                
                let url = '';
                let title = '';
                
                if (target === 'url') {
                    url = keyword;
                    if (!/^https?:\/\//i.test(url)) {
                        url = 'https://' + url;
                    }
                    title = 'Custom URL';
                } else {
                    const encodedKeyword = encodeURIComponent(keyword);
                    const boardMap = {
                        'total': { 
                            url: `https://m.fmkorea.com/search.php?act=IS&is_keyword=${encodedKeyword}#gsc.tab=&gsc.q=leehs&gsc.sort=date&`, 
                            title: 'Ìé®ÏΩî Í≤ÄÏÉâ' 
                        },
                        'best': { 
                            url: `https://m.fmkorea.com/search.php?mid=best&search_target=title_content&search_keyword=${encodedKeyword}`, 
                            title: 'Ìè¨ÌÖê Í≤ÄÏÉâ' 
                        },
                        'soccer': { 
                            url: `https://m.fmkorea.com/search.php?mid=football_world&category=&search_target=title&search_keyword=${encodedKeyword}`, 
                            title: 'Ìï¥Ï∂ï Í≤ÄÏÉâ' 
                        },
                        'humor': { 
                            url: `https://m.fmkorea.com/search.php?mid=humor&category=&search_target=title_content&search_keyword=${encodedKeyword}`, 
                            title: 'Ïú†Î®∏ Í≤ÄÏÉâ' 
                        },
                        'news': { 
                            url: `https://m.fmkorea.com/search.php?mid=football_news&category=&search_target=title_content&search_keyword=${encodedKeyword}`, 
                            title: 'Ï∂ïÏÜåÌÜµ Í≤ÄÏÉâ' 
                        }
                    };
                    
                    const board = boardMap[target];
                    url = board.url;
                    title = board.title;
                }
                
                loadSite(url, title);
                document.getElementById('searchKeyword').value = '';
            }

            function goToMobileSite() {
                window.location.href = 'https://netflix7774.github.io/mobile/index.html';
            }

            function exportBookmarks() {
                const bms = localStorage.getItem('myHubBookmarks');
                if (!bms) return alert('ÎÇ¥Î≥¥ÎÇº Î∂ÅÎßàÌÅ¨Í∞Ä ÏóÜÏäµÎãàÎã§.');
                const blob = new Blob([bms], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `pro_hub_bookmarks_${new Date().toISOString().slice(0,10)}.json`;
                a.click();
                URL.revokeObjectURL(url);
            }

            function importBookmarks() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = '.json';
                input.onchange = e => {
                    const file = e.target.files[0];
                    if (!file) return;
                    const reader = new FileReader();
                    reader.onload = event => {
                        try {
                            const data = JSON.parse(event.target.result);
                            if (Array.isArray(data)) {
                                if(confirm('Í∏∞Ï°¥ Î∂ÅÎßàÌÅ¨Î•º ÎçÆÏñ¥Ïì∞Í≥† ÏÉàÎ°ú Í∞ÄÏ†∏Ïò§ÏãúÍ≤†ÏäµÎãàÍπå?')) {
                                    localStorage.setItem('myHubBookmarks', JSON.stringify(data));
                                    renderBookmarks();
                                    alert('Î∂ÅÎßàÌÅ¨ ÎèôÍ∏∞ÌôîÍ∞Ä ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.');
                                }
                            } else alert('Ïú†Ìö®Ìïú Î∂ÅÎßàÌÅ¨ ÌòïÏãùÏù¥ ÏïÑÎãôÎãàÎã§.');
                        } catch (err) { alert('ÌååÏùº ÏùΩÍ∏∞ Ïò§Î•òÏûÖÎãàÎã§.'); }
                    };
                    reader.readAsText(file);
                };
                input.click();
            }

            function setSplitMode(mode) {
                splitMode = mode;
                selectedFrameIndex = 0;
                activeFrameSet = 0;
                
                document.getElementById('splitDropdown').classList.remove('show');
                
                document.querySelectorAll('.split-dropdown-item').forEach(item => item.classList.remove('active'));
                event.target.classList.add('active');
                
                const modeNames = {
                    'single': '1x1',
                    'split2': '1x2',
                    'split3': '1x3',
                    'horizontal': '1x4',
                    'vertical2': '2x1',
                    'grid': '2x2'
                };
                document.querySelector('.btn-split-current').innerText = modeNames[mode] + ' ‚ñº';
                
                renderFrames();
            }

            function renderFrames() {
                const wrap = document.getElementById('frameWrap');
                wrap.className = `frame-wrap split-${splitMode}`;
                wrap.innerHTML = '';

                if (splitMode === 'single') {
                    wrap.innerHTML = `
                        <div class="frame-container" id="container-0">
                            <div class="floating-title" id="title-container-0">
                                <a id="title-0" href="${frameUrls[0]}" target="_blank">${frameTitles[0]}</a>
                            </div>
                            <iframe id="frame-0" src="${frameUrls[0]}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        </div>
                    `;
                    currentUrl = frameUrls[0];
                    
                    const frame = document.getElementById('frame-0');
                    frame.onload = () => {
                        applyPcCrop();
                        applyDarkMode();
                        restoreScrollPosition(0);
                    };
                } else if (splitMode === 'split2') {
                    const maxFrames = 2;
                    const offset = activeFrameSet * maxFrames;
                    
                    for (let i = 0; i < maxFrames; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        container.style.width = `${frameSizes.split2[i]}%`;
                        
                        const realIndex = offset + i;
                        const otherSetSlot = (1 - activeFrameSet) * maxFrames + i + 1;
                        
                        container.innerHTML = `
                            <div class="frame-selector" onclick="selectFrame(${i});">${realIndex + 1}</div>
                            <div class="frame-set-display" style="position: absolute; top: 50px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; z-index: 998;">${otherSetSlot}</div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[realIndex] || '#'}" target="_blank">${frameTitles[realIndex] || `ÌîÑÎ†àÏûÑ ${realIndex + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[realIndex] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        const frame = document.getElementById(`frame-${i}`);
                        if (frame && frameUrls[realIndex]) {
                            frame.onload = ((index) => {
                                return () => {
                                    applyPcCrop();
                                    applyDarkMode();
                                    restoreScrollPosition(offset + index);
                                };
                            })(i);
                        }
                        
                        if (i < 1) {
                            const resizer = document.createElement('div');
                            resizer.className = 'resizer vertical';
                            resizer.dataset.index = i;
                            resizer.style.left = `${frameSizes.split2.slice(0, i + 1).reduce((a, b) => a + b, 0)}%`;
                            resizer.addEventListener('mousedown', startResize);
                            wrap.appendChild(resizer);
                        }
                    }
                    
                    // ÏÑ∏Ìä∏ Ï†ÑÌôò Î≤ÑÌäº Ï∂îÍ∞Ä
                    const toggleBtn = document.createElement('div');
                    toggleBtn.className = 'frame-set-toggle';
                    if (activeFrameSet === 1) toggleBtn.classList.add('active');
                    toggleBtn.innerHTML = `üîÑ ${activeFrameSet === 0 ? '1-2' : '3-4'}`;
                    toggleBtn.onclick = toggleFrameSet;
                    wrap.appendChild(toggleBtn);
                    
                    updateFrameSelection();
                } else if (splitMode === 'split3') {
                    const maxFrames = 3;
                    const offset = activeFrameSet * maxFrames;
                    
                    for (let i = 0; i < maxFrames; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        container.style.width = `${frameSizes.split3[i]}%`;
                        
                        const realIndex = offset + i;
                        const otherSetSlot = (1 - activeFrameSet) * maxFrames + i + 1;
                        
                        container.innerHTML = `
                            <div class="frame-selector" onclick="selectFrame(${i});">${realIndex + 1}</div>
                            <div class="frame-set-display" style="position: absolute; top: 50px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; z-index: 998;">${otherSetSlot}</div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[realIndex] || '#'}" target="_blank">${frameTitles[realIndex] || `ÌîÑÎ†àÏûÑ ${realIndex + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[realIndex] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        const frame = document.getElementById(`frame-${i}`);
                        if (frame && frameUrls[realIndex]) {
                            frame.onload = ((index) => {
                                return () => {
                                    applyPcCrop();
                                    applyDarkMode();
                                    restoreScrollPosition(offset + index);
                                };
                            })(i);
                        }
                        
                        if (i < 2) {
                            const resizer = document.createElement('div');
                            resizer.className = 'resizer vertical';
                            resizer.dataset.index = i;
                            resizer.style.left = `${frameSizes.split3.slice(0, i + 1).reduce((a, b) => a + b, 0)}%`;
                            resizer.addEventListener('mousedown', startResize);
                            wrap.appendChild(resizer);
                        }
                    }
                    
                    // ÏÑ∏Ìä∏ Ï†ÑÌôò Î≤ÑÌäº Ï∂îÍ∞Ä
                    const toggleBtn = document.createElement('div');
                    toggleBtn.className = 'frame-set-toggle';
                    if (activeFrameSet === 1) toggleBtn.classList.add('active');
                    toggleBtn.innerHTML = `üîÑ ${activeFrameSet === 0 ? '1-3' : '4-6'}`;
                    toggleBtn.onclick = toggleFrameSet;
                    wrap.appendChild(toggleBtn);
                    
                    updateFrameSelection();
                } else if (splitMode === 'horizontal') {
                    const maxFrames = 4;
                    const offset = activeFrameSet * maxFrames;
                    
                    for (let i = 0; i < maxFrames; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        container.style.width = `${frameSizes.horizontal[i]}%`;
                        
                        const realIndex = offset + i;
                        const otherSetSlot = (1 - activeFrameSet) * maxFrames + i + 1;
                        
                        container.innerHTML = `
                            <div class="frame-selector" onclick="selectFrame(${i});">${realIndex + 1}</div>
                            <div class="frame-set-display" style="position: absolute; top: 50px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; z-index: 998;">${otherSetSlot}</div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[realIndex] || '#'}" target="_blank">${frameTitles[realIndex] || `ÌîÑÎ†àÏûÑ ${realIndex + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[realIndex] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        const frame = document.getElementById(`frame-${i}`);
                        if (frame && frameUrls[realIndex]) {
                            frame.onload = ((index) => {
                                return () => {
                                    applyPcCrop();
                                    applyDarkMode();
                                    restoreScrollPosition(offset + index);
                                };
                            })(i);
                        }
                        
                        if (i < 3) {
                            const resizer = document.createElement('div');
                            resizer.className = 'resizer vertical';
                            resizer.dataset.index = i;
                            resizer.style.left = `${frameSizes.horizontal.slice(0, i + 1).reduce((a, b) => a + b, 0)}%`;
                            resizer.addEventListener('mousedown', startResize);
                            wrap.appendChild(resizer);
                        }
                    }
                    
                    // ÏÑ∏Ìä∏ Ï†ÑÌôò Î≤ÑÌäº Ï∂îÍ∞Ä
                    const toggleBtn = document.createElement('div');
                    toggleBtn.className = 'frame-set-toggle';
                    if (activeFrameSet === 1) toggleBtn.classList.add('active');
                    toggleBtn.innerHTML = `üîÑ ${activeFrameSet === 0 ? '1-4' : '5-8'}`;
                    toggleBtn.onclick = toggleFrameSet;
                    wrap.appendChild(toggleBtn);
                    
                    updateFrameSelection();
                } else if (splitMode === 'vertical2') {
                    const maxFrames = 2;
                    const offset = activeFrameSet * maxFrames;
                    
                    for (let i = 0; i < maxFrames; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        container.style.width = '100%';
                        container.style.height = `${frameSizes.vertical2[i]}%`;
                        
                        const realIndex = offset + i;
                        const otherSetSlot = (1 - activeFrameSet) * maxFrames + i + 1;
                        
                        container.innerHTML = `
                            <div class="frame-selector" onclick="selectFrame(${i});">${realIndex + 1}</div>
                            <div class="frame-set-display" style="position: absolute; top: 50px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; z-index: 998;">${otherSetSlot}</div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[realIndex] || '#'}" target="_blank">${frameTitles[realIndex] || `ÌîÑÎ†àÏûÑ ${realIndex + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[realIndex] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        const frame = document.getElementById(`frame-${i}`);
                        if (frame && frameUrls[realIndex]) {
                            frame.onload = ((index) => {
                                return () => {
                                    applyPcCrop();
                                    applyDarkMode();
                                    restoreScrollPosition(offset + index);
                                };
                            })(i);
                        }
                        
                        if (i < 1) {
                            const resizer = document.createElement('div');
                            resizer.className = 'resizer horizontal';
                            resizer.dataset.index = i;
                            resizer.style.top = `${frameSizes.vertical2.slice(0, i + 1).reduce((a, b) => a + b, 0)}%`;
                            resizer.addEventListener('mousedown', startResize);
                            wrap.appendChild(resizer);
                        }
                    }
                    
                    const toggleBtn = document.createElement('div');
                    toggleBtn.className = 'frame-set-toggle';
                    if (activeFrameSet === 1) toggleBtn.classList.add('active');
                    toggleBtn.innerHTML = `üîÑ ${activeFrameSet === 0 ? '1-2' : '3-4'}`;
                    toggleBtn.onclick = toggleFrameSet;
                    wrap.appendChild(toggleBtn);
                    
                    updateFrameSelection();
                } else if (splitMode === 'grid') {
                    const maxFrames = 4;
                    const offset = activeFrameSet * maxFrames;
                    
                    for (let i = 0; i < maxFrames; i++) {
                        const container = document.createElement('div');
                        container.className = 'frame-container';
                        container.id = `container-${i}`;
                        
                        if (i < 2) {
                            container.style.height = `${frameSizes.grid[0]}%`;
                        } else {
                            container.style.height = `${frameSizes.grid[2]}%`;
                        }
                        
                        if (i % 2 === 0) {
                            container.style.width = `${frameSizes.grid[i]}%`;
                        } else {
                            container.style.width = `${frameSizes.grid[i]}%`;
                        }
                        
                        const realIndex = offset + i;
                        const otherSetSlot = (1 - activeFrameSet) * maxFrames + i + 1;
                        
                        container.innerHTML = `
                            <div class="frame-selector" onclick="selectFrame(${i});">${realIndex + 1}</div>
                            <div class="frame-set-display" style="position: absolute; top: 50px; left: 10px; background: rgba(0,0,0,0.6); color: white; padding: 4px 8px; border-radius: 12px; font-size: 10px; font-weight: bold; z-index: 998;">${otherSetSlot}</div>
                            <div class="floating-title" id="title-container-${i}">
                                <a id="title-${i}" href="${frameUrls[realIndex] || '#'}" target="_blank">${frameTitles[realIndex] || `ÌîÑÎ†àÏûÑ ${realIndex + 1}`}</a>
                            </div>
                            <iframe id="frame-${i}" src="${frameUrls[realIndex] || ''}" allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share; fullscreen" allowfullscreen></iframe>
                        `;
                        
                        wrap.appendChild(container);
                        
                        const frame = document.getElementById(`frame-${i}`);
                        if (frame && frameUrls[realIndex]) {
                            frame.onload = ((index) => {
                                return () => {
                                    applyPcCrop();
                                    applyDarkMode();
                                    restoreScrollPosition(offset + index);
                                };
                            })(i);
                        }
                    }
                    
                    const hResizer = document.createElement('div');
                    hResizer.className = 'resizer horizontal';
                    hResizer.dataset.index = '0';
                    hResizer.style.top = `${frameSizes.grid[0]}%`;
                    hResizer.addEventListener('mousedown', startResize);
                    wrap.appendChild(hResizer);
                    
                    const vResizer1 = document.createElement('div');
                    vResizer1.className = 'resizer vertical';
                    vResizer1.dataset.index = '0';
                    vResizer1.style.left = `${frameSizes.grid[0]}%`;
                    vResizer1.style.height = `${frameSizes.grid[0]}%`;
                    vResizer1.addEventListener('mousedown', startResize);
                    wrap.appendChild(vResizer1);
                    
                    const vResizer2 = document.createElement('div');
                    vResizer2.className = 'resizer vertical';
                    vResizer2.dataset.index = '1';
                    vResizer2.style.left = `${frameSizes.grid[2]}%`;
                    vResizer2.style.top = `${frameSizes.grid[0]}%`;
                    vResizer2.style.height = `${100 - frameSizes.grid[0]}%`;
                    vResizer2.addEventListener('mousedown', startResize);
                    wrap.appendChild(vResizer2);
                    
                    // ÏÑ∏Ìä∏ Ï†ÑÌôò Î≤ÑÌäº Ï∂îÍ∞Ä
                    const toggleBtn = document.createElement('div');
                    toggleBtn.className = 'frame-set-toggle';
                    if (activeFrameSet === 1) toggleBtn.classList.add('active');
                    toggleBtn.innerHTML = `üîÑ ${activeFrameSet === 0 ? '1-4' : '5-8'}`;
                    toggleBtn.onclick = toggleFrameSet;
                    wrap.appendChild(toggleBtn);
                    
                    updateFrameSelection();
                }
                
                setTimeout(() => {
                    applyPcCrop();
                    applyDarkMode();
                    updateFrameSelection();
                }, 100);
            }

            function startResize(e) {
                e.preventDefault();
                e.stopPropagation();
                resizeState.isResizing = true;
                resizeState.targetIndex = parseInt(e.target.dataset.index);
                resizeState.direction = e.target.classList.contains('horizontal') ? 'horizontal' : 'vertical';
                resizeState.startPos = resizeState.direction === 'horizontal' ? e.clientY : e.clientX;
                
                e.target.classList.add('dragging');
                
                document.addEventListener('mousemove', handleResize);
                document.addEventListener('mouseup', stopResize);
            }

            function handleResize(e) {
                if (!resizeState.isResizing) return;
                
                const wrap = document.getElementById('frameWrap');
                const rect = wrap.getBoundingClientRect();
                
                if (splitMode === 'split2') {
                    const deltaX = e.clientX - resizeState.startPos;
                    const deltaPercent = (deltaX / rect.width) * 100;
                    
                    const idx = resizeState.targetIndex;
                    const newSize1 = frameSizes.split2[idx] + deltaPercent;
                    const newSize2 = frameSizes.split2[idx + 1] - deltaPercent;
                    
                    if (newSize1 > 10 && newSize2 > 10) {
                        frameSizes.split2[idx] = newSize1;
                        frameSizes.split2[idx + 1] = newSize2;
                        resizeState.startPos = e.clientX;
                        renderFrames();
                    }
                } else if (splitMode === 'split3') {
                    const deltaX = e.clientX - resizeState.startPos;
                    const deltaPercent = (deltaX / rect.width) * 100;
                    
                    const idx = resizeState.targetIndex;
                    const newSize1 = frameSizes.split3[idx] + deltaPercent;
                    const newSize2 = frameSizes.split3[idx + 1] - deltaPercent;
                    
                    if (newSize1 > 10 && newSize2 > 10) {
                        frameSizes.split3[idx] = newSize1;
                        frameSizes.split3[idx + 1] = newSize2;
                        resizeState.startPos = e.clientX;
                        renderFrames();
                    }
                } else if (splitMode === 'horizontal') {
                    const deltaX = e.clientX - resizeState.startPos;
                    const deltaPercent = (deltaX / rect.width) * 100;
                    
                    const idx = resizeState.targetIndex;
                    const newSize1 = frameSizes.horizontal[idx] + deltaPercent;
                    const newSize2 = frameSizes.horizontal[idx + 1] - deltaPercent;
                    
                    if (newSize1 > 10 && newSize2 > 10) {
                        frameSizes.horizontal[idx] = newSize1;
                        frameSizes.horizontal[idx + 1] = newSize2;
                        resizeState.startPos = e.clientX;
                        renderFrames();
                    }
                } else if (splitMode === 'vertical2') {
                    const deltaY = e.clientY - resizeState.startPos;
                    const deltaPercent = (deltaY / rect.height) * 100;
                    
                    const newSize1 = frameSizes.vertical2[0] + deltaPercent;
                    const newSize2 = frameSizes.vertical2[1] - deltaPercent;
                    
                    if (newSize1 > 10 && newSize2 > 10) {
                        frameSizes.vertical2[0] = newSize1;
                        frameSizes.vertical2[1] = newSize2;
                        resizeState.startPos = e.clientY;
                        renderFrames();
                    }
                } else if (splitMode === 'grid') {
                    if (resizeState.direction === 'horizontal') {
                        const deltaY = e.clientY - resizeState.startPos;
                        const deltaPercent = (deltaY / rect.height) * 100;
                        
                        const newSize1 = frameSizes.grid[0] + deltaPercent;
                        const newSize2 = 100 - newSize1;
                        
                        if (newSize1 > 20 && newSize2 > 20) {
                            frameSizes.grid[0] = frameSizes.grid[1] = newSize1;
                            frameSizes.grid[2] = frameSizes.grid[3] = newSize2;
                            resizeState.startPos = e.clientY;
                            renderFrames();
                        }
                    } else {
                        const deltaX = e.clientX - resizeState.startPos;
                        const deltaPercent = (deltaX / rect.width) * 100;
                        
                        if (resizeState.targetIndex === 0) {
                            const newSize = frameSizes.grid[0] + deltaPercent;
                            if (newSize > 20 && newSize < 80) {
                                frameSizes.grid[0] = frameSizes.grid[2] = newSize;
                                frameSizes.grid[1] = frameSizes.grid[3] = 100 - newSize;
                                resizeState.startPos = e.clientX;
                                renderFrames();
                            }
                        }
                    }
                }
            }

            function stopResize(e) {
                if (!resizeState.isResizing) return;
                
                resizeState.isResizing = false;
                document.querySelectorAll('.resizer').forEach(r => r.classList.remove('dragging'));
                
                document.removeEventListener('mousemove', handleResize);
                document.removeEventListener('mouseup', stopResize);
            }

            window.onload = () => {
                if (!localStorage.getItem('myHubBookmarks')) localStorage.setItem('myHubBookmarks', JSON.stringify([{ name: 'Ìè¨ÌÖê', url: 'https://m.fmkorea.com/' }]));
                renderBookmarks();
                renderFrames();
                
                // Îã§ÌÅ¨Î™®Îìú Ï¥àÍ∏∞Ìôî
                if (isDarkMode) {
                    document.getElementById('darkModeBtn').classList.add('active');
                }
                
                // ÎÇ†Ïßú/ÏãúÍ∞Ñ Ï¥àÍ∏∞ ÌëúÏãú
                updateDateTime();
            };
        </script>
    </body>
</html>
